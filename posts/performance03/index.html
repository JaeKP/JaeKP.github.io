<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="실전-웹-성능-최적화-(feat. React)-Part2" /><meta name="author" content="박재경" /><meta property="og:locale" content="ko" /><meta name="description" content="강의 링크" /><meta property="og:description" content="강의 링크" /><link rel="canonical" href="https://jaekp.github.io/posts/performance03/" /><meta property="og:url" content="https://jaekp.github.io/posts/performance03/" /><meta property="og:site_name" content="Hello, World!" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-11-12T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="실전-웹-성능-최적화-(feat. React)-Part2" /><meta name="google-site-verification" content="LP7vGYSUszERSVMH1MoT4NXRTCcbUaUtfFm_pOYcoQ4" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"박재경"},"dateModified":"2022-11-12T16:23:49+09:00","datePublished":"2022-11-12T00:00:00+09:00","description":"강의 링크","headline":"실전-웹-성능-최적화-(feat. React)-Part2","mainEntityOfPage":{"@type":"WebPage","@id":"https://jaekp.github.io/posts/performance03/"},"url":"https://jaekp.github.io/posts/performance03/"}</script><title>실전-웹-성능-최적화-(feat. React)-Part2 | Hello, World!</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Hello, World!"><meta name="application-name" content="Hello, World!"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/mococo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Hello, World!</a></div><div class="site-subtitle font-italic">난 재경쓰!</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/JaeKP" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['jkp71192','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>실전-웹-성능-최적화-(feat. React)-Part2</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>실전-웹-성능-최적화-(feat. React)-Part2</h1><div class="post-meta text-muted"><div> By <em> 박재경 </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1668178800" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-11-12 </em> </span> <span> Updated <em class="timeago" data-ts="1668237829" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-11-12 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="6443 words"> <em>35 min</em> read</span></div></div></div><div class="post-content"><p><a href="https://www.inflearn.com/course/%EC%9B%B9-%EC%84%B1%EB%8A%A5-%EC%B5%9C%EC%A0%81%ED%99%94-%EB%A6%AC%EC%95%A1%ED%8A%B8-2">강의 링크</a></p><p><strong>웹 성능은 크게 두 가지로 분류할 수 있다.</strong></p><p>바로, 로딩 성능과 렌더링 성능이다.</p><ul><li>로딩 성능: 각 리소스를 불러오는 성능을 의미한다.<li>렌더링 성능: 불러온 리소스를 화면에 보여주는 성능을 의미한다.</ul><p><br /></p><h1 id="1-일반-홈페이지-최적화">1. 일반 홈페이지 최적화</h1><p><code class="language-plaintext highlighter-rouge">사용하는 툴</code></p><ul><li>크롬 Network 탭<li>크롬 Performance 탭<li>크롬 Lighthouse 탭<li>Coverage 탭</ul><p><br /></p><h2 id="1-이미지-레이지lazy-로딩"><span class="mr-2">1) 이미지 레이지(lazy) 로딩</span><a href="#1-이미지-레이지lazy-로딩" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">로딩 성능 최적화</code></p><p>가끔 히어로 컨텐츠보다 이미지가 먼저 로딩 되어 중요한 컨텐츠의 로딩이 늦어지는 경우가 있다. 히어로 컨텐츠보다 먼저 로딩되는 이미지들을 처리하는 방법은 두가지가 있다.</p><ul><li>최대한 빠르게 이미지를 다운로드한다. (궁극적인 해결방법이 아니다. )<li>이미지는 당장 눈에 보이는 요소가 아니기 때문에 나중에 로딩 시킨다.</ul><p><br /></p><h3 id="1-이미지-레이지-로딩"><span class="mr-2">(1) 이미지 레이지 로딩</span><a href="#1-이미지-레이지-로딩" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="prompt-tip"><div><p>이미지를 나중에 필요할때 로딩하겠다라는 의미이다.</p></div></blockquote><p>그렇다면 해당 이미지들은 언제 불려야할까?</p><p>바로 이미지가 보여지는 순간 혹은 직전에 이미지가 로드되면 좋을 것이다.</p><p>이미지가 스크롤에 닿는 순간에 이미지를 로드한다.</p><p>즉, 이미지가 보여지는 요소까지 스크롤이 된다면 이미지를 로딩하는 것이다.</p><p><strong>스크롤 이벤트를 통해, 스크롤이 이미지가 있는 곳까지 판단을 해서 이미지를 로드한다.</strong></p><p><br /></p><h3 id="2-intersection-observer"><span class="mr-2">(2) intersection observer</span><a href="#2-intersection-observer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="prompt-tip"><div><p>스크롤 이벤트마다 많은 함수가 실행된다는 단점이 있다. 이는 <code class="language-plaintext highlighter-rouge">intersection observer</code>를 통해 해결할 수 있다.</p></div></blockquote><p><code class="language-plaintext highlighter-rouge">intersection observer</code>를 통해 특정 엘레멘트를 observer를 하면, 해당 요소가 화면에 보여지는 지를 확인할 수 있다.</p><p><strong>즉, 화면에 이미지가 보여지면 로딩을 하는 것이다.</strong></p><p>성능에 이득을 챙길 수 있다.</p><p><br /></p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">createObserver</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">observer</span><span class="p">;</span>
    
  <span class="kd">let</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">root</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="na">rootMargin</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0px</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">threshold</span><span class="p">:</span> <span class="nx">buildThresholdList</span><span class="p">()</span>
  <span class="p">};</span>

    <span class="c1">// args: 콜백 함수, options 객체</span>
  <span class="nx">observer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IntersectionObserver</span><span class="p">(</span><span class="nx">handleIntersect</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
    
    <span class="c1">// observe라는 메서드를 통해 DOMElement를 이제 observe 상태가 된다.</span>
  <span class="nx">observer</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">boxElement</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><ul><li><strong>콜백함수는 처음엔 oberve할 때, 페이지에서 보일 때, 페이지에서 안 보일때 호출한다.</strong></ul><p><br /></p><h3 id="3-리액트에-적용하기"><span class="mr-2">(3) 리액트에 적용하기</span><a href="#3-리액트에-적용하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">Card</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">imgRef</span> <span class="o">=</span> <span class="nx">useRef</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>

  <span class="c1">// 마운트할 때 한번만 하면 된다.</span>
  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{};</span>
      
    <span class="kd">const</span> <span class="nx">callback</span> <span class="o">=</span> <span class="p">(</span><span class="nx">entries</span><span class="p">,</span> <span class="nx">observer</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">entries</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">entry</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="c1">// 2. 이미지가 보이는 순간에만 콜백함수가 실행하도록 한다.</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">isIntersecting</span><span class="p">)</span> <span class="p">{</span>
           <span class="c1">// 3. data-src속성에 저장한 이미지 소스를 넣는다.</span>
          <span class="nx">entry</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">src</span><span class="p">;</span>
            <span class="c1">// 4. 이미지를 넣었으면 이제 unobserve한다.</span>
          <span class="nx">observer</span><span class="p">.</span><span class="nx">unobserve</span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">target</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">};</span>
    <span class="kd">const</span> <span class="nx">observer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IntersectionObserver</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>

     <span class="c1">// 1. useRef를 통해 접근한다.</span>
    <span class="nx">observer</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">imgRef</span><span class="p">.</span><span class="nx">current</span><span class="p">);</span>
  <span class="p">},</span> <span class="p">[])</span>

	<span class="k">return</span> <span class="p">(</span>
		<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">Card text-center</span><span class="dl">"</span><span class="o">&gt;</span>
			<span class="o">&lt;</span><span class="nx">img</span> <span class="nx">data</span><span class="o">-</span><span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">image</span><span class="p">}</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">imgRef</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>			<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">p-5 font-semibold text-gray-700 text-xl md:text-lg lg:text-xl keep-all</span><span class="dl">"</span><span class="o">&gt;</span>
				<span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">}</span>
			<span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>		<span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>	<span class="p">)</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Card</span>
</pre></table></code></div></div><p><br /></p><h2 id="2-이미지-사이즈-최적화"><span class="mr-2">2) 이미지 사이즈 최적화</span><a href="#2-이미지-사이즈-최적화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">로딩 성능 최적화</code></p><p>이미지 자체가 너무 커서 로딩하는 것 조차 네트워크 리소스를 많이 잡아 먹을 때가 있다.</p><p>큰 사이즈를 이미지를 우리가 필요한 사이즈의 이미지로 줄이고 압축을 통해 더 낮은 용량의 이미지를 만들 수 있다.</p><p><br /></p><h3 id="1-이미지-사이즈-포맷"><span class="mr-2">(1) 이미지 사이즈 포맷</span><a href="#1-이미지-사이즈-포맷" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>PNG: 무손실 압축으로 용량이 크다<li>JPG: 압축이 되어있다.<ul><li>PNG 보다 JPG 사용을 권장한다.</ul><li>WEBP: JPG보다 더 좋은 이미지 포맷<ul><li>지원하지 않는 브라우저가 존재한다<li>화질, 사이즈, 용량에 있어서 JPG보다 성능이 좋다.</ul></ul><p><strong>squoosh.app사이트를 통해 이미지를 변환한다.</strong></p><p><br /></p><h3 id="2-분기-추가하기"><span class="mr-2">(2) 분기 추가하기</span><a href="#2-분기-추가하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="prompt-tip"><div><p>WEBP를 지원하지 않는 브라우저가 존재한다. <code class="language-plaintext highlighter-rouge">&lt;picture&gt;</code>태그를 활용하여 브라우저 별로 이미지 확장자를 다르게 제공할 수 있다.</p></div></blockquote><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- 사이즈 --&gt;</span>
<span class="nt">&lt;picture&gt;</span>
  <span class="nt">&lt;source</span> <span class="na">srcset=</span><span class="s">"mdn-logo-wide.png"</span> <span class="na">media=</span><span class="s">"(min-width: 600px)"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"mdn-logo-narrow.png"</span> <span class="na">alt=</span><span class="s">"MDN"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/picture&gt;</span>


<span class="c">&lt;!-- 확장자 --&gt;</span>
<span class="nt">&lt;picture&gt;</span>
  <span class="nt">&lt;source</span> <span class="na">srcset=</span><span class="s">"photo.avif"</span> <span class="na">type=</span><span class="s">"image/avif"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;source</span> <span class="na">srcset=</span><span class="s">"photo.webp"</span> <span class="na">type=</span><span class="s">"image/webp"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"photo.jpg"</span> <span class="na">alt=</span><span class="s">"photo"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/picture&gt;</span>
</pre></table></code></div></div><p><br /></p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nt">&lt;picture&gt;</span>
	<span class="nt">&lt;source</span> <span class="na">data-srcset=</span><span class="s">{main_items_webp}</span> <span class="na">type=</span><span class="s">"image/webp"</span> <span class="nt">/&gt;</span>
	<span class="nt">&lt;img</span> <span class="na">data-src=</span><span class="s">{main_items}</span> <span class="na">ref=</span><span class="s">{imgEl1}</span> <span class="na">alt=</span><span class="s">""</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/picture&gt;</span>
</pre></table></code></div></div><ul><li>webp 파일 확장자를 제공하면 main_items_webp 이미지를 제공한다.<li>그러지 않을 경우 main_items 이미지를 제공한다.</ul><p><br /></p><h3 id="3-webp에도-레이지-로딩-적용하기"><span class="mr-2">(3) webp에도 레이지 로딩 적용하기</span><a href="#3-webp에도-레이지-로딩-적용하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">callback</span> <span class="o">=</span> <span class="p">(</span><span class="nx">entries</span><span class="p">,</span> <span class="nx">observer</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">entries</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">entry</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">isIntersecting</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">src</span><span class="p">);</span>
			
            <span class="c1">//이전 태그 (soure태그를 잡는다)</span>
            <span class="kd">const</span> <span class="nx">sourceEl</span> <span class="o">=</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">previousSibling</span><span class="p">;</span>
            <span class="nx">sourceEl</span><span class="p">.</span><span class="nx">srcset</span> <span class="o">=</span> <span class="nx">sourceEl</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">srcset</span><span class="p">;</span>
            <span class="nx">entry</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">entry</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">src</span><span class="p">;</span>

            <span class="nx">observer</span><span class="p">.</span><span class="nx">unobserve</span><span class="p">(</span><span class="nx">entry</span><span class="p">.</span><span class="nx">target</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></table></code></div></div><p><br /></p><h2 id="3-동영상-최적화"><span class="mr-2">3) 동영상 최적화</span><a href="#3-동영상-최적화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">로딩 성능 최적화</code></p><p><br /></p><h3 id="1-동영상-압축"><span class="mr-2">(1) 동영상 압축</span><a href="#1-동영상-압축" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>동영상도 가로와 세로의 사이즈가 있고 화질에 따라 용량이 달라진다.</p><p>단순하게, 동영상을 작은 용량을 압축해 주는 작업을 통해 최적화를 한다.</p><p>그런데, 동영상 화질이 저하되기 때문에 동영상이 메인 컨텐츠면 해당 방법을 추천하지 않는다.</p><ul><li><p><code class="language-plaintext highlighter-rouge">media.io</code> 에서 압축한다.</p><li><p>WEBM 확장자로 압축</p></ul><p><br /></p><h3 id="2-분기-처리"><span class="mr-2">(2) 분기 처리</span><a href="#2-분기-처리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="prompt-tip"><div><p>WEBM을 지원하지 않는 브라우저가 존재하기 때문에 분기처리를 해야 한다.</p></div></blockquote><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="o">&lt;</span><span class="nx">video</span> <span class="nx">autoPlay</span> <span class="nx">loop</span> <span class="nx">muted</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">source</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">video_webm</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">video/webm</span><span class="dl">"</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="nx">source</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">video</span><span class="p">}</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">video/mp4</span><span class="dl">"</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="sr">/video</span><span class="err">&gt;
</span></pre></table></code></div></div><p><br /></p><h3 id="3-화질-팁"><span class="mr-2">(3) 화질 팁</span><a href="#3-화질-팁" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="prompt-tip"><div><p>화질이 너무 저하되면 오히려 유저의 경험이 나빠질 수 있다.</p></div></blockquote><ul><li>영상 길이를 줄이고 영상을 반복한다.<li>영상 위에 작은 도트를 반복해서 올린다. (동영상이 메인 컨텐츠가 아닐 때 )<li>영상 자체에 블러처리를 한다. (동영상이 메인 컨텐츠가 아닐 때 )</ul><p><br /></p><h2 id="4-폰트-최적화"><span class="mr-2">4) 폰트 최적화</span><a href="#4-폰트-최적화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">로딩 성능 최적화</code></p><p>폰트를 로딩하느라, 텍스트가 나중에 화면에 보일 수 있다. (텍스트가 깜빡거린다)</p><p>폰트는 하나의 리소스로서 네트워크에 다운받는다.</p><ul><li>FOUT (Flash of Unstyled Text): 폰트를 다운로드 하기 전에는 기본 폰트로 텍스트를 보여준다.<ul><li>IE, Edge 브라우저</ul><li>FOIT (Flash of Invisible Text): 폰트를 다운로드 하기 전에는 아예 텍스트를 보여주지 않는다.<ul><li>Chrome , 사파리 브라우저</ul></ul><p>궁극적으로 웹폰트를 최적화 하여 위의 현상을 최소화 해야 한다.</p><p><br /></p><h3 id="1-웹-폰트-적용-시점-컨트롤"><span class="mr-2">(1) 웹 폰트 적용 시점 컨트롤</span><a href="#1-웹-폰트-적용-시점-컨트롤" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="prompt-tip"><div><p>font-display 속성을 활용하여 FOUT와 FOIT를 컨트롤 할 수 있다.</p></div></blockquote><div class="table-wrapper"><table><thead><tr><th>속성<th>설명<tbody><tr><td><code class="language-plaintext highlighter-rouge">auto</code><td>브라우저 기본 동작<tr><td><code class="language-plaintext highlighter-rouge">block</code><td>FOIT (timeout = 3s)<br />텍스트를 보여주지 않다가 3초 이내에 다운로드가 안되면, 3초 후에 기본 폰트를 적용한다.<tr><td><code class="language-plaintext highlighter-rouge">swap</code><td>FOUT<tr><td><code class="language-plaintext highlighter-rouge">fallback</code><td>FOIT (timeout = 0.1s)<br />텍스트를 보여주지 않다가 0.1초 이내에 다운로드가 안되면, 0.1초 후에 기본 폰트를 적용한다. 3초 후에도 불러오지 못했을 시, 기본 폰트로 유지한다. 다운로드된 폰트는 캐시해둔다.<tr><td><code class="language-plaintext highlighter-rouge">optional</code><td>FOIT (timeout = 0.1s)<br />이후 네트워크 상태에 따라 기본 폰트로 유지 할지 웹폰트를 적용할지 결정한다. 폰트를 캐시해둔다.<br /><strong>구글에서는 optional을 권장한다.</strong></table></div><p><br /></p><h3 id="2-페이드-효과"><span class="mr-2">(2) 페이드 효과</span><a href="#2-페이드-효과" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="prompt-tip"><div><p>유저 체감 성능을 위해 fade효과를 적용할 수 있다.</p><p>폰트가 로드가 된 시점을 캐치해서 이벤트를 넣어준다.</p></div></blockquote><ul><li>폰트가 다운로드 되기 전에는 opacity 0을 준다<li>폰트가 다운로드 되면 opacity 1을 준다.</ul><p>폰트가 다운되었는지 파악하기 위해서는 <a href="https://www.npmjs.com/package/fontfaceobserver">fontfaceobserver</a>를 사용하면 된다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>npm <span class="nb">install </span>fontfaceobserver
</pre></table></code></div></div><p><br /></p><div class="language-react highlighter-rouge"><div class="code-header"> <span data-label-text="React"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="nx">FontFaceObserver</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">fontfaceobserver</span><span class="dl">'</span>

<span class="kd">function</span> <span class="nx">BannerVideo</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">isFontLoaded</span><span class="p">,</span> <span class="nx">setIsFontLoaded</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">font</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FontFaceObserver</span><span class="p">(</span><span class="dl">'</span><span class="s1">BMYEONSUNG</span><span class="dl">'</span><span class="p">);</span>

  <span class="c1">// 폰트가 로드 되었는지 확인한다.</span>
  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">font</span><span class="p">.</span><span class="nx">load</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="nx">setIsFontLoaded</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">},</span> <span class="p">[]);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style</span><span class="p">=&gt;</span>
      <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>KEEP<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">BannerVideo</span>
</pre></table></code></div></div><p><br /></p><h3 id="2-폰트-사이즈-줄이기"><span class="mr-2">(2) 폰트 사이즈 줄이기</span><a href="#2-폰트-사이즈-줄이기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><h4 id="2-1-웹폰트-포멧-사용"><span class="mr-2">2-1. 웹폰트 포멧 사용</span><a href="#2-1-웹폰트-포멧-사용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p><img data-src="https://raw.githubusercontent.com/JaeKP/image_repo/main/img/image-20221111111104979.png" alt="image-20221111111104979" data-proofer-ignore></p><ul><li>파일 크기: EOT &gt; TTF/OTF &gt; WOFF &gt; WOFF2<li><code class="language-plaintext highlighter-rouge">transfonter.org</code>에서 폰트 포맷을 변환한다.</ul><p><br /></p><p>지원하지 않는 브라우저를 생각해야 한다.</p><div class="language-css highlighter-rouge"><div class="code-header"> <span data-label-text="CSS"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">@font-face</span> <span class="p">{</span>
  <span class="nl">font-family</span><span class="p">:</span> <span class="n">BMYEONSUNG</span><span class="p">;</span>
  <span class="nl">src</span><span class="p">:</span> <span class="sx">url('./assets/fonts/BMYEONSUNG.woff2')</span> <span class="n">format</span><span class="p">(</span><span class="s2">'woff2'</span><span class="p">),</span>
      <span class="sx">url('./assets/fonts/BMYEONSUNG.woff')</span> <span class="n">format</span><span class="p">(</span><span class="s2">'woff'</span><span class="p">),</span>
      <span class="sx">url('./assets/fonts/BMYEONSUNG.ttf')</span> <span class="n">format</span><span class="p">(</span><span class="s2">'truetype'</span><span class="p">);</span>
  <span class="py">font-display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><br /></p><h4 id="2-2-local-폰트-사용"><span class="mr-2">2-2. local 폰트 사용</span><a href="#2-2-local-폰트-사용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-css highlighter-rouge"><div class="code-header"> <span data-label-text="CSS"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="k">@font-face</span> <span class="p">{</span>
  <span class="nl">font-family</span><span class="p">:</span> <span class="n">BMYEONSUNG</span><span class="p">;</span>
  <span class="nl">src</span><span class="p">:</span> <span class="n">local</span><span class="p">(</span><span class="s2">'BMYEONSUNG'</span><span class="p">)</span> 
      <span class="sx">url('./assets/fonts/BMYEONSUNG.woff2')</span> <span class="n">format</span><span class="p">(</span><span class="s2">'woff2'</span><span class="p">),</span>
      <span class="sx">url('./assets/fonts/BMYEONSUNG.woff')</span> <span class="n">format</span><span class="p">(</span><span class="s2">'woff'</span><span class="p">),</span>
      <span class="sx">url('./assets/fonts/BMYEONSUNG.ttf')</span> <span class="n">format</span><span class="p">(</span><span class="s2">'truetype'</span><span class="p">);</span>
  <span class="py">font-display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><ul><li>local 키워드를 사용하면 이미 사용자가 PC에 존재하는 폰트를 체크해서 네트워크 없이 폰트를 사용할 수 있다.</ul><p><br /></p><h4 id="2-3-subset-사용"><span class="mr-2">2-3. Subset 사용</span><a href="#2-3-subset-사용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><blockquote class="prompt-tip"><div><p>사용하는 글자만 일부 가져온다.</p></div></blockquote><p><code class="language-plaintext highlighter-rouge">transfonter.org</code>사이트에서 특정 글자만 가져올 수 있다. <code class="language-plaintext highlighter-rouge">Characters</code>칼럼에 작성</p><ul><li>폰트 파일 사이즈가 작아지기 때문에 폰트가 엄청 빠르게 로딩된다.</ul><p><br /></p><h4 id="2-4-unicode-range-적용"><span class="mr-2">2-4. Unicode Range 적용</span><a href="#2-4-unicode-range-적용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><blockquote class="prompt-tip"><div><p>unicode-range를 사용하여 특정 유니코드 값을 작성하면 지정된 유니코드에만 폰트를 적용한다는 의미이다.</p></div></blockquote><div class="language-css highlighter-rouge"><div class="code-header"> <span data-label-text="CSS"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">@font-face</span> <span class="p">{</span>
  <span class="nl">font-family</span><span class="p">:</span> <span class="n">BMYEONSUNG</span><span class="p">;</span>
  <span class="nl">src</span><span class="p">:</span> <span class="n">local</span><span class="p">(</span><span class="s2">'BMYEONSUNG'</span><span class="p">)</span> 
      <span class="sx">url('./assets/fonts/BMYEONSUNG.woff2')</span> <span class="n">format</span><span class="p">(</span><span class="s2">'woff2'</span><span class="p">),</span>
      <span class="sx">url('./assets/fonts/BMYEONSUNG.woff')</span> <span class="n">format</span><span class="p">(</span><span class="s2">'woff'</span><span class="p">),</span>
      <span class="sx">url('./assets/fonts/BMYEONSUNG.ttf')</span> <span class="n">format</span><span class="p">(</span><span class="s2">'truetype'</span><span class="p">);</span>
  <span class="py">font-display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
    
  <span class="c">/* 'A'만 폰트를 적용한다.*/</span>
  <span class="py">unicode-range</span><span class="p">:</span> <span class="n">u</span><span class="err">+</span><span class="m">0041</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><ul><li>불필요한 폰트를 로딩하는 것을 막는다.</ul><p><br /></p><h4 id="2-5-data-uri로-변환"><span class="mr-2">2-5. data-uri로 변환</span><a href="#2-5-data-uri로-변환" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><blockquote class="prompt-tip"><div><p><code class="language-plaintext highlighter-rouge">transfonter.org</code>사이트에서 base64 토클을 키고 변환한다.</p></div></blockquote><ul><li><p>data-uri는 이미지 등의 외부 바이너리 파일을 웹페이지에 인라인으로 넣기 위해서 사용한다.</p><li><p>네트워크 호출이 아니기 때문에 용량이 커진 대신 별도로 폰트 파일을 가져오지는 않는다.</p></ul><p><br /></p><h4 id="2-6-폰트-preload"><span class="mr-2">2-6. 폰트 Preload</span><a href="#2-6-폰트-preload" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>CSS보다 먼저 불리기 위해서는 HTML 파일에 알려줘야 한다.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"preload"</span> <span class="na">href=</span><span class="s">"./static/mdeia/BMYEONGSUNG.b184ad44.woff2"</span> <span class="na">as=</span><span class="s">"font"</span> <span class="na">type=</span><span class="s">"font/woff2"</span> <span class="na">crossorigin</span><span class="nt">&gt;</span>
</pre></table></code></div></div><ul><li>html이 로드하자마자 폰트가 어떤 리소스보다 먼저 load한다. (css, js 보다)</ul><p>이는 webpack을 수정해서 적용할 수도 있다.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1">// config-overrides.js </span>

<span class="kd">const</span> <span class="nx">PreloadWebpackPlugin</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">preload-webpack-plugin</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">override</span><span class="p">(</span><span class="nx">config</span><span class="p">,</span> <span class="nx">env</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">config</span><span class="p">.</span><span class="nx">plugins</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">PreloadWebpackPlugin</span><span class="p">({</span>
    <span class="na">rel</span><span class="p">:</span> <span class="dl">'</span><span class="s1">preload</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">as</span><span class="p">:</span> <span class="dl">'</span><span class="s1">font</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">include</span><span class="p">:</span> <span class="dl">'</span><span class="s1">allAssets</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">fileWhitelist</span><span class="p">:</span> <span class="p">[</span><span class="sr">/</span><span class="se">(</span><span class="sr">.woff2</span><span class="se">?)</span><span class="sr">/i</span><span class="p">]</span>
  <span class="p">}));</span>

  <span class="k">return</span> <span class="nx">config</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><br /></p><h2 id="5-캐시-최적화"><span class="mr-2">5) 캐시 최적화</span><a href="#5-캐시-최적화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">로딩 성능 최적화</code></p><p><img data-src="https://raw.githubusercontent.com/JaeKP/image_repo/main/img/image-20221111125901380.png" alt="image-20221111125901380" data-proofer-ignore></p><ul><li>효율적인 캐시 정책이 적용되어 있지 않다.<li>리소스들의 캐시 설정을 적용해야 한다.<li>cache-control이라는 헤더를 통해 캐시 설정을 할 수 있다.</ul><p><br /></p><h3 id="1-캐시란"><span class="mr-2">(1) 캐시란</span><a href="#1-캐시란" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="prompt-tip"><div><p>데이터나 값을 미리 복사해 놓는 임시 장소나 그런 동작이다.</p></div></blockquote><p>웹 브라우저는 두 가지 장법으로 캐싱을 한다.</p><ul><li>메모리 캐시: RAM에 데이터를 저장해두는 방식<li>disk: file로 데이터를 저장하고 file을 읽어서 캐시를 불러들인다.</ul><p><br /></p><p><img data-src="https://raw.githubusercontent.com/JaeKP/image_repo/main/img/image-20221111130417918.png" alt="image-20221111130417918" data-proofer-ignore></p><ul><li>브라우저의 알고리즘에 따라서 알아서 적용된다.</ul><p><br /></p><h3 id="2-cache-control"><span class="mr-2">(2) cache-control</span><a href="#2-cache-control" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>브라우저가 특정 리소스를 요청할 때 cache-control이 http 헤더에 추가하여 캐시 관련 설정을 할 수 있다. 즉, 서버에서 설정을 해주어야 한다.</p><p>ex) 몇 초 동안 캐시를 유지해~</p><p><br /></p><div class="table-wrapper"><table><thead><tr><th>속성<th>설명<tbody><tr><td><code class="language-plaintext highlighter-rouge">no-cache</code><td>캐시를 사용하기 전에 서버에 검사 후 사용을 결정한다. <br />max-age=0과 유사하다.<tr><td><code class="language-plaintext highlighter-rouge">no-store</code><td>캐시를 사용 안한다.<tr><td><code class="language-plaintext highlighter-rouge">public</code><td>모든 환경에서 캐시 사용이 가능하다.<tr><td><code class="language-plaintext highlighter-rouge">private</code><td>브라우저 환경에서만 캐시를 사용한다. 외부 캐시 서버에서는 사용 불가하다.<tr><td><code class="language-plaintext highlighter-rouge">max-age</code><td>캐시의 유효시간 (sconds기준)<br />캐시가 만료되면 서버에 계속 사용해도 되는 지 물어본다. 서버의 응답에 따라 다시 요청할 지가 결정된다.<br /><code class="language-plaintext highlighter-rouge">304</code>: not modified (다시 요청하지 않고 계속 쓴다.)</table></div><p>그렇다면 서버는 어떻게 리소스가 변경되었음을 알 수 있는 걸까?</p><ul><li>리소스에는 ETag가 붙어있다. 해쉬와 유사하다.<li>브라우저가 리소스를 가지고 있을 때 <code class="language-plaintext highlighter-rouge">ETag</code>를 가지고 있다. 서버에게 이 이미지 사용해도 괜찮아? 라고 물어볼때 <code class="language-plaintext highlighter-rouge">ETag</code>를 보내준다. 서버는 <code class="language-plaintext highlighter-rouge">ETag</code>의 변화 상태를 감지하여 브라우저에게 다시 알려주어 브라우저가 리소스를 다시 요청할지 결정하게 된다.</ul><p><br /></p><p><img data-src="https://raw.githubusercontent.com/JaeKP/image_repo/main/img/image-20221111142311127.png" alt="image-20221111142311127" data-proofer-ignore></p><p><br /></p><h3 id="3-node를-활용한-서버-설정"><span class="mr-2">(3) node를 활용한 서버 설정</span><a href="#3-node를-활용한-서버-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="c1">//server.js</span>

<span class="kd">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">express</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">()</span>
<span class="kd">const</span> <span class="nx">port</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">)</span>


<span class="kd">const</span> <span class="nx">header</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">setHeaders</span><span class="p">:</span> <span class="p">(</span><span class="nx">res</span><span class="p">,</span> <span class="nx">path</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
     <span class="nx">res</span><span class="p">.</span><span class="nx">setHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Cache-Control</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">max-age=20</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">},</span>
<span class="p">}</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="kd">static</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">../build</span><span class="dl">'</span><span class="p">),</span> <span class="nx">header</span><span class="p">))</span>
<span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">*</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">sendFile</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">../build/index.html</span><span class="dl">'</span><span class="p">))</span>
<span class="p">})</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">port</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Example app listening at http://localhost:</span><span class="p">${</span><span class="nx">port</span><span class="p">}</span><span class="s2">`</span><span class="p">))</span>
</pre></table></code></div></div><p><br /></p><h3 id="4-리소스별-관리"><span class="mr-2">(4) 리소스별 관리</span><a href="#4-리소스별-관리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="prompt-tip"><div><p>캐시는 최신 데이터를 어떻게 즉각 반영할 지가 중요하다.</p><p>그런데 절대 변경이 발생하지 않는 리소스가 있다면 캐시를 오랫동안 하는 것이 좋다.</p></div></blockquote><ul><li>html 리소스: 즉각 변경을 위해 캐시가 걸려있지 않는 것이 좋다.<ul><li>수정사항을 바로바로 반영할 수 없다.<li><code class="language-plaintext highlighter-rouge">no-cahe</code></ul><li>js, css 리소스: 항상 최신으로 유지되어 있어야 한다.<ul><li>그러나 webpack을 사용하여 번들링 할 때, js가 수정되면 최신의 js 리소스를 생성하기에 수정을 반영할 필요가 없다.<ul><li>버전을 위해 해쉬를 설정하기 때문</ul><li>항상 최신의 html을 유지하기에 항상 최신의 js를 요청하게 된다.<li><code class="language-plaintext highlighter-rouge">max-age=30d</code></ul></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>html: no-cache
js: public, max-age: 3153600
css: public, max-age: 3153600
img: public, max-age: 3153600
</pre></table></code></div></div><p><br /></p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="c1">//server.js</span>

<span class="kd">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">express</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">()</span>
<span class="kd">const</span> <span class="nx">port</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">)</span>


<span class="kd">const</span> <span class="nx">header</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">setHeaders</span><span class="p">:</span> <span class="p">(</span><span class="nx">res</span><span class="p">,</span> <span class="nx">path</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">endsWith</span><span class="p">(</span><span class="dl">'</span><span class="s1">.html</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">setHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Cache-Control</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">no-cache</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">endsWith</span><span class="p">(</span><span class="dl">'</span><span class="s1">.js</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="nx">path</span><span class="p">.</span><span class="nx">endsWith</span><span class="p">(</span><span class="dl">'</span><span class="s1">.css</span><span class="dl">'</span><span class="p">)</span> <span class="o">||</span> <span class="nx">path</span><span class="p">.</span><span class="nx">endsWith</span><span class="p">(</span><span class="dl">'</span><span class="s1">.webp</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">setHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Cache-Control</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">public, max-age=31536000</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">res</span><span class="p">.</span><span class="nx">setHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Cache-Control</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">no-store</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">}</span>
  <span class="p">},</span>
<span class="p">}</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="kd">static</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">../build</span><span class="dl">'</span><span class="p">),</span> <span class="nx">header</span><span class="p">))</span>
<span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">*</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nx">sendFile</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">../build/index.html</span><span class="dl">'</span><span class="p">))</span>
<span class="p">})</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">port</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Example app listening at http://localhost:</span><span class="p">${</span><span class="nx">port</span><span class="p">}</span><span class="s2">`</span><span class="p">))</span>
</pre></table></code></div></div><h2 id="6-불필요한-css-제거"><span class="mr-2">6) 불필요한 CSS 제거</span><a href="#6-불필요한-css-제거" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">로딩 성능 최적화</code></p><ul><li>Coverage 탭을 활용<li>해당 파일에서 실제로 사용하는 코드의 비율을 보여준다.<li>css 파일 사이즈를 줄이는데 도움을 준다.</ul><p><br /></p><h3 id="1-purgecss"><span class="mr-2">(1) Purge.css</span><a href="#1-purgecss" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$npm</span> i purgecss <span class="nt">--save-dev</span>
</pre></table></code></div></div><p>CSS에서 사용하지 않는 선택기를 제거하여 CSS 파일을 더 작게 만든다.</p><p><br /></p><h1 id="2-이미지-갤러리-서비스-최적화">2. 이미지 갤러리 서비스 최적화</h1><h2 id="1-layout-shife-피하기"><span class="mr-2">1) Layout Shife 피하기</span><a href="#1-layout-shife-피하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">렌더링 성능 최적화</code></p><p><img data-src="https://raw.githubusercontent.com/JaeKP/image_repo/main/img/image-20221111160443569.png" alt="image-20221111160443569" data-proofer-ignore></p><p><br /></p><p><img data-src="https://raw.githubusercontent.com/JaeKP/image_repo/main/img/image-20221111160525519.png" alt="image-20221111160525519" data-proofer-ignore></p><p><strong>랜더링이 느려서, 요소들이 이동하는 현상</strong></p><ul><li>화면상에서 위치를 다시 계산해야 한다.<li>사용성에 큰 영향을 준다.</ul><p><br /></p><h3 id="1-원인"><span class="mr-2">(1) 원인</span><a href="#1-원인" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><p>사이즈가 정해져 있지 않은 이미지</p><li>사이즈가 정해져 있지 않은 광고<li>동적으로 삽입된 콘텐츠<li>Web font (FOIT, FOUT)</ul><p><br /></p><h3 id="2-해결방안"><span class="mr-2">(2) 해결방안</span><a href="#2-해결방안" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>사이즈가 정해져 있지 않아 문제가 발생하는 경우,</p><ul><li>사이즈를 px이나 rem와 같이 고정시키면 된다.<li>반응형을 한다면, 가로 세로 비율을 고정함으로 사이즈를 정할 수 있다.</ul><p><br /></p><div class="language-react highlighter-rouge"><div class="code-header"> <span data-label-text="React"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">styled</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">styled-components</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">PhotoItem</span><span class="p">({</span> <span class="na">photo</span><span class="p">:</span> <span class="p">{</span> <span class="nx">urls</span><span class="p">,</span> <span class="nx">alt</span> <span class="p">}</span> <span class="p">})</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">ImageWrap</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nc">Image</span> <span class="na">src</span><span class="p">=</span><span class="si">{</span><span class="nx">urls</span><span class="p">.</span><span class="nx">small</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&amp;t=</span><span class="dl">'</span> <span class="o">+</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">()</span><span class="si">}</span> <span class="na">alt</span><span class="p">=</span><span class="si">{</span><span class="nx">alt</span><span class="si">}</span><span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="nc">ImageWrap</span><span class="p">&gt;</span>
  <span class="p">);</span>
<span class="p">}</span>

<span class="c1">// padding을 활용하여 너비의 56.25만큼 높이를 준다.</span>
<span class="kd">const</span> <span class="nx">ImageWrap</span> <span class="o">=</span> <span class="nx">styled</span><span class="p">.</span><span class="nx">div</span><span class="s2">`
  width: 100%;
  padding-bottom: 56.25%;
  position: relative;
`</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">Image</span> <span class="o">=</span> <span class="nx">styled</span><span class="p">.</span><span class="nx">img</span><span class="s2">`
  cursor: pointer;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
`</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">PhotoItem</span><span class="p">;</span>
</pre></table></code></div></div><p><br /></p><h2 id="2-이미지-지연lazy-로딩"><span class="mr-2">2) 이미지 지연(lazy) 로딩</span><a href="#2-이미지-지연lazy-로딩" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">로딩 성능 최적화</code></p><p>react-lazyload를 활용하여 좀 더 간편하게 이미지 레이지로딩을 할 수 있다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>npm <span class="nb">install</span> <span class="nt">--save</span> react-lazyload
</pre></table></code></div></div><p><br /></p><div class="language-react highlighter-rouge"><div class="code-header"> <span data-label-text="React"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="nx">styled</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">styled-components</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">LazyLoad</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-lazyload</span><span class="dl">'</span><span class="p">;</span>


<span class="kd">function</span> <span class="nx">PhotoItem</span><span class="p">({</span> <span class="na">photo</span><span class="p">:</span> <span class="p">{</span> <span class="nx">urls</span><span class="p">,</span> <span class="nx">alt</span> <span class="p">}</span> <span class="p">})</span> <span class="p">{</span>
  <span class="c1">// LazyLoad는 스크롤 이벤트를 사용한다. </span>
  <span class="c1">// offset은 얼마나 미리 로딩하겠는가이다. 1000px이전에 이미지를 미리 불러온다. </span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">ImageWrap</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nc">LazyLoad</span> <span class="na">offset</span><span class="p">=</span><span class="si">{</span><span class="mi">1000</span><span class="si">}</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nc">Image</span> <span class="na">src</span><span class="p">=</span><span class="si">{</span><span class="nx">urls</span><span class="p">.</span><span class="nx">small</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&amp;t=</span><span class="dl">'</span> <span class="o">+</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">()</span><span class="si">}</span> <span class="na">alt</span><span class="p">=</span><span class="si">{</span><span class="nx">alt</span><span class="si">}</span> <span class="na">onClick</span><span class="p">=</span><span class="si">{</span><span class="nx">openModal</span><span class="si">}</span> <span class="p">/&gt;</span>
      <span class="p">&lt;/</span><span class="nc">LazyLoad</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nc">ImageWrap</span><span class="p">&gt;</span>
  <span class="p">);</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">ImageWrap</span> <span class="o">=</span> <span class="nx">styled</span><span class="p">.</span><span class="nx">div</span><span class="s2">`
  width: 100%;
  padding-bottom: 56.25%;
  position: relative;
`</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">Image</span> <span class="o">=</span> <span class="nx">styled</span><span class="p">.</span><span class="nx">img</span><span class="s2">`
  cursor: pointer;
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
`</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">PhotoItem</span><span class="p">;</span>
</pre></table></code></div></div><p><br /></p><h2 id="3-useselector-렌더링-문제-해결"><span class="mr-2">3) useSelector 렌더링 문제 해결</span><a href="#3-useselector-렌더링-문제-해결" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">렌더링 성능 최적화</code></p><p>리액트 렌더링 라이프 사이클은 성능에 많은 영향을 미친다.</p><p>불필요한 시점에 발생하는 렌더링이나 빈번하게 발생하는 렌더링은 성능에 많은 영향을 미친다.</p><ul><li>서비스에 어떤 타이밍에 컴포넌트가 렌더링이 되는 지 확인하기위해 ReactDevTool을 사용하면 된다.<li>의도한 렌더링이 맞는지 확인해야 한다.</ul><p><br /></p><h3 id="1-useselector-원리"><span class="mr-2">(1) useSelector 원리</span><a href="#1-useselector-원리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-src="https://raw.githubusercontent.com/JaeKP/image_repo/main/img/image-20221112135258119.png" alt="image-20221112135258119" data-proofer-ignore></p><ul><li>Redux Store에는 다양한 State가 존재한다. 컴포넌트는 State를 구독하고 있다.<li>만약, State가 변경되어 Store도 변경된다면, 구독된 컴포넌트들에게 State가 변경되었음을 알린다.<li>component는 변경되었다는 State와 이전 State와 비교하여 State가 변경되었으면 리렌더링을 한다.<li>그런데 useSelector과 값을 비교하는 방식은 return값을 통해 비교한다.<ul><li>a,b의 값을 갖는 객체이다.<li>state가 변하면 객체를 새로 반환한다.</ul></ul><p>그래서 State가 변하지 않아도 리렌더링 되는 상황이 발생하는 것이다.</p><p><br /></p><p><code class="language-plaintext highlighter-rouge">해결 방안</code></p><ol><li>Object를 새로 만들지 않도록 State 쪼개기<li>새로운 Equality Function 사용</ol><p><br /></p><h3 id="2-object를-새로-만들지-않도록-state-쪼개기"><span class="mr-2">(2) Object를 새로 만들지 않도록 State 쪼개기</span><a href="#2-object를-새로-만들지-않도록-state-쪼개기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-react highlighter-rouge"><div class="code-header"> <span data-label-text="React"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useSelector</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-redux</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ImageModal</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../components/ImageModal</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// 이전 코드</span>
<span class="kd">function</span> <span class="nx">ImageModalContainer</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">modalVisible</span><span class="p">,</span> <span class="nx">bgColor</span><span class="p">,</span> <span class="nx">src</span><span class="p">,</span> <span class="nx">alt</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">(</span>
    <span class="nx">state</span> <span class="o">=&gt;</span> <span class="p">({</span>
      <span class="na">modalVisible</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">imageModal</span><span class="p">.</span><span class="nx">modalVisible</span><span class="p">,</span>
      <span class="na">bgColor</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">imageModal</span><span class="p">.</span><span class="nx">bgColor</span><span class="p">,</span>
      <span class="na">src</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">imageModal</span><span class="p">.</span><span class="nx">src</span><span class="p">,</span>
      <span class="na">alt</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">imageModal</span><span class="p">.</span><span class="nx">alt</span><span class="p">,</span>
    <span class="p">}),</span>
  <span class="p">);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">ImageModal</span>
      <span class="na">modalVisible</span><span class="p">=</span><span class="si">{</span><span class="nx">modalVisible</span><span class="si">}</span>
      <span class="na">bgColor</span><span class="p">=</span><span class="si">{</span><span class="nx">bgColor</span><span class="si">}</span>
      <span class="na">src</span><span class="p">=</span><span class="si">{</span><span class="nx">src</span><span class="si">}</span>
      <span class="na">alt</span><span class="p">=</span><span class="si">{</span><span class="nx">alt</span><span class="si">}</span>
    <span class="p">/&gt;</span>
  <span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">ImageModalContainer</span><span class="p">;</span>
</pre></table></code></div></div><p>위와 같이 object로 반환하는 것이 아니라 단일 값으로 만든다.</p><p><br /></p><div class="language-react highlighter-rouge"><div class="code-header"> <span data-label-text="React"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useSelector</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-redux</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ImageModal</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../components/ImageModal</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// state를 분리한다. </span>
<span class="kd">const</span> <span class="nx">modlaVisible</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">(</span><span class="nx">state</span> <span class="o">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">imageModal</span><span class="p">.</span><span class="nx">modalVisible</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">bgColor</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">(</span><span class="nx">state</span> <span class="o">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">imageModal</span><span class="p">.</span><span class="nx">bgColor</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">src</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">(</span><span class="nx">state</span> <span class="o">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">imageModal</span><span class="p">.</span><span class="nx">src</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">alt</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">(</span><span class="nx">state</span> <span class="o">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">imageModal</span><span class="p">.</span><span class="nx">alt</span><span class="p">);</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">ImageModal</span>
      <span class="na">modalVisible</span><span class="p">=</span><span class="si">{</span><span class="nx">modalVisible</span><span class="si">}</span>
      <span class="na">bgColor</span><span class="p">=</span><span class="si">{</span><span class="nx">bgColor</span><span class="si">}</span>
      <span class="na">src</span><span class="p">=</span><span class="si">{</span><span class="nx">src</span><span class="si">}</span>
      <span class="na">alt</span><span class="p">=</span><span class="si">{</span><span class="nx">alt</span><span class="si">}</span>
    <span class="p">/&gt;</span>
  <span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">ImageModalContainer</span><span class="p">;</span>
</pre></table></code></div></div><p><br /></p><h4 id="3-새로운-equality-function-사용"><span class="mr-2">(3) 새로운 Equality Function 사용</span><a href="#3-새로운-equality-function-사용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-react highlighter-rouge"><div class="code-header"> <span data-label-text="React"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useSelector</span><span class="p">,</span> <span class="nx">shallowEqual</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-redux</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ImageModal</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../components/ImageModal</span><span class="dl">'</span><span class="p">;</span>

<span class="c1">// 새로운 값을 비교하는 equality 함수를 useSelector 인자에 추가한다. </span>
<span class="c1">// 기본적으로는 단순 비교를 한다. </span>
<span class="kd">function</span> <span class="nx">ImageModalContainer</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">modalVisible</span><span class="p">,</span> <span class="nx">bgColor</span><span class="p">,</span> <span class="nx">src</span><span class="p">,</span> <span class="nx">alt</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">(</span>
    <span class="nx">state</span> <span class="o">=&gt;</span> <span class="p">({</span>
      <span class="na">modalVisible</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">imageModal</span><span class="p">.</span><span class="nx">modalVisible</span><span class="p">,</span>
      <span class="na">bgColor</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">imageModal</span><span class="p">.</span><span class="nx">bgColor</span><span class="p">,</span>
      <span class="na">src</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">imageModal</span><span class="p">.</span><span class="nx">src</span><span class="p">,</span>
      <span class="na">alt</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">imageModal</span><span class="p">.</span><span class="nx">alt</span><span class="p">,</span>
    <span class="p">}),</span><span class="nx">shallowEqual</span><span class="p">);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">ImageModal</span>
      <span class="na">modalVisible</span><span class="p">=</span><span class="si">{</span><span class="nx">modalVisible</span><span class="si">}</span>
      <span class="na">bgColor</span><span class="p">=</span><span class="si">{</span><span class="nx">bgColor</span><span class="si">}</span>
      <span class="na">src</span><span class="p">=</span><span class="si">{</span><span class="nx">src</span><span class="si">}</span>
      <span class="na">alt</span><span class="p">=</span><span class="si">{</span><span class="nx">alt</span><span class="si">}</span>
    <span class="p">/&gt;</span>
  <span class="p">);</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">ImageModalContainer</span><span class="p">;</span>
</pre></table></code></div></div><ul><li>shallowEqual은 단순 비교가 아닌 첫번째 depth에 있는 값들을 각각 비교한다.</ul><p><br /></p><h2 id="4-redux-reselect를-통한-렌더링-최적화"><span class="mr-2">4) Redux Reselect를 통한 렌더링 최적화</span><a href="#4-redux-reselect를-통한-렌더링-최적화" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">렌더링 성능 최적화</code></p><p><code class="language-plaintext highlighter-rouge">reselect</code>는 리더스와 같이 사용하는 라이브러리로 state에 있는 값을 가공해야 하는 경우 가공된 값을 state에서 관리할 수 있도록 한다.</p><div class="language-react highlighter-rouge"><div class="code-header"> <span data-label-text="React"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">useEffect</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">shallowEqual</span><span class="p">,</span> <span class="nx">useDispatch</span><span class="p">,</span> <span class="nx">useSelector</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-redux</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">PhotoList</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../components/PhotoList</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">fetchPhotos</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../redux/photos</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">PhotoListContainer</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">dispatch</span> <span class="o">=</span> <span class="nx">useDispatch</span><span class="p">();</span>

  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">dispatch</span><span class="p">(</span><span class="nx">fetchPhotos</span><span class="p">());</span>
  <span class="p">},</span> <span class="p">[</span><span class="nx">dispatch</span><span class="p">]);</span>

  <span class="kd">const</span> <span class="p">{</span> <span class="nx">category</span><span class="p">,</span> <span class="nx">allPhotos</span><span class="p">,</span> <span class="nx">loading</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">(</span>
    <span class="nx">state</span> <span class="o">=&gt;</span> <span class="p">({</span>
      <span class="na">category</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">category</span><span class="p">.</span><span class="nx">category</span><span class="p">,</span>
      <span class="na">allPhotos</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">photos</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span>
      <span class="na">loading</span><span class="p">:</span> <span class="nx">state</span><span class="p">.</span><span class="nx">photos</span><span class="p">.</span><span class="nx">loading</span><span class="p">,</span>
    <span class="p">}),</span>
    <span class="nx">shallowEqual</span>
  <span class="p">);</span>

  <span class="c1">// photos를 store에서 관리할 수 있도록 한다!</span>
  <span class="kd">const</span> <span class="nx">photos</span> <span class="o">=</span>
    <span class="nx">category</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">all</span><span class="dl">'</span>
      <span class="p">?</span> <span class="nx">allPhotos</span>
      <span class="p">:</span> <span class="nx">allPhotos</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">photo</span> <span class="o">=&gt;</span> <span class="nx">photo</span><span class="p">.</span><span class="nx">category</span> <span class="o">===</span> <span class="nx">category</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">loading</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span>Error!<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">loading</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">done</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span>loading...<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">&lt;</span><span class="nc">PhotoList</span> <span class="na">photos</span><span class="p">=</span><span class="si">{</span><span class="nx">photos</span><span class="si">}</span> <span class="p">/&gt;;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">PhotoListContainer</span><span class="p">;</span>
</pre></table></code></div></div><p><br /></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>npm <span class="nb">install </span>reselect
</pre></table></code></div></div><p><br /></p><h3 id="1-createselector"><span class="mr-2">(1) createSelector</span><a href="#1-createselector" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><blockquote class="prompt-tip"><div><p>store에서 데이터를 꺼내오기위한 함수를 selector라고 한다.</p><p>우리는 reselctor 라이브러리로 selector를 생성할 수 있다.</p></div></blockquote><p><br /></p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1">// 예시</span>
<span class="nx">createSelector</span><span class="p">([</span><span class="nx">select할</span> <span class="nx">값</span><span class="p">],</span> <span class="nx">값에</span> <span class="nx">적용할</span> <span class="nx">함수</span><span class="p">)</span>

<span class="kd">const</span> <span class="nx">selectFilteredPhotos</span> <span class="o">=</span> <span class="nx">createSelector</span> <span class="p">([</span><span class="nx">state</span> <span class="o">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">photos</span><span class="p">.</span><span class="nx">data</span><span class="p">],</span> <span class="nx">photos</span> <span class="o">=&gt;</span> <span class="nx">photos</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">photos</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">(</span><span class="nx">selectFilteredPhotos</span><span class="p">);</span>
</pre></table></code></div></div><p><br /></p><p><code class="language-plaintext highlighter-rouge">적용해보기</code></p><div class="language-react highlighter-rouge"><div class="code-header"> <span data-label-text="React"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c1">// src/redux/photos</span>
<span class="c1">// createSelector로 로직을 연결하여 값을 가져오기</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">createSelector</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">reselect</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">createSelector</span><span class="p">(</span>
  <span class="p">[</span><span class="nx">state</span> <span class="o">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">photos</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">state</span> <span class="o">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">category</span><span class="p">.</span><span class="nx">category</span><span class="p">],</span>
  <span class="p">(</span><span class="nx">photos</span><span class="p">,</span> <span class="nx">category</span><span class="p">)</span> <span class="o">=&gt;</span>
    <span class="nx">category</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">all</span><span class="dl">'</span>
      <span class="p">?</span> <span class="nx">photos</span>
      <span class="p">:</span> <span class="nx">photos</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">photo</span> <span class="o">=&gt;</span> <span class="nx">photo</span><span class="p">.</span><span class="nx">category</span> <span class="o">===</span> <span class="nx">category</span><span class="p">)</span>
<span class="p">);</span>
</pre></table></code></div></div><ul><li>memoization 기법에 의해 reselect는 함수에 똑같은 인자가 들어오면 반환 값을 이미 캐시된 값으로 전달한다.<li>매번 값을 계산하지 않는다.</ul><p><br /></p><div class="language-react highlighter-rouge"><div class="code-header"> <span data-label-text="React"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">useEffect</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useDispatch</span><span class="p">,</span> <span class="nx">useSelector</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-redux</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">PhotoList</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../components/PhotoList</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">fetchPhotos</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../redux/photos</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">selectFilteredPhotos</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">../redux/selector/selectFilteredPhotos</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">PhotoListContainer</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">dispatch</span> <span class="o">=</span> <span class="nx">useDispatch</span><span class="p">();</span>

  <span class="nx">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">dispatch</span><span class="p">(</span><span class="nx">fetchPhotos</span><span class="p">());</span>
  <span class="p">},</span> <span class="p">[</span><span class="nx">dispatch</span><span class="p">]);</span>

  <span class="kd">const</span> <span class="nx">photos</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">(</span><span class="nx">selectFilteredPhotos</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">loading</span> <span class="o">=</span> <span class="nx">useSelector</span><span class="p">(</span><span class="nx">state</span> <span class="o">=&gt;</span> <span class="nx">state</span><span class="p">.</span><span class="nx">photos</span><span class="p">.</span><span class="nx">loading</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">loading</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span>Error!<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;;</span>
  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">loading</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">done</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span>loading...<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">&lt;</span><span class="nc">PhotoList</span> <span class="na">photos</span><span class="p">=</span><span class="si">{</span><span class="nx">photos</span><span class="si">}</span> <span class="p">/&gt;;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">PhotoListContainer</span><span class="p">;</span>
</pre></table></code></div></div><p><br /></p><h2 id="5-병목-함수에-memoization-적용"><span class="mr-2">5) 병목 함수에 memoization 적용</span><a href="#5-병목-함수에-memoization-적용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">렌더링 성능 최적화</code></p><p>함수에는 인풋과 아웃풋이 있다. memoization은 특정 input에 따른 output의 값을 미리 저장해 놓는 것을 의미한다.</p><p>즉, 매번 함수를 실행시키지 않는다.</p><p>들어오는 input이 매번 같거나 함수가 헤비한 경우 매우 효율적으로 함수를 구현할 수 있다.</p><p><br /></p><h3 id="1-예제"><span class="mr-2">(1) 예제</span><a href="#1-예제" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>input값을 알아야한다.<li>만약 동일한 input값이 왔다면, 캐시한 데이터를 반환한다.<li>순수함수여야 memoization을 적용할 수 있다. (동일한 input에 대해서 동일한 output을 보장하는 함수이다.)</ul><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="c1">// 캐시할 데이터 </span>
<span class="kd">const</span> <span class="nx">cache</span> <span class="o">=</span> <span class="p">{};</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nx">getAverageColorOfImage</span><span class="p">(</span><span class="nx">imgElement</span><span class="p">)</span> <span class="p">{</span>
    
  <span class="c1">// input값 체크하여 만약 동일한 input이면 저장된 값을 반환한다.</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">cache</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">imgElement</span><span class="p">.</span><span class="nx">src</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">cache</span><span class="p">[</span><span class="nx">imgElement</span><span class="p">.</span><span class="nx">src</span><span class="p">];</span>
  <span class="p">}</span>

  <span class="kd">const</span> <span class="nx">canvas</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">canvas</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">context</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span> <span class="o">&amp;&amp;</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="dl">'</span><span class="s1">2d</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">averageColor</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">r</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="na">g</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="na">b</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">};</span>

  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">averageColor</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">const</span> <span class="nx">width</span> <span class="o">=</span> <span class="p">(</span><span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span>
    <span class="nx">imgElement</span><span class="p">.</span><span class="nx">naturalWidth</span> <span class="o">||</span> <span class="nx">imgElement</span><span class="p">.</span><span class="nx">offsetWidth</span> <span class="o">||</span> <span class="nx">imgElement</span><span class="p">.</span><span class="nx">width</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">height</span> <span class="o">=</span> <span class="p">(</span><span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span>
    <span class="nx">imgElement</span><span class="p">.</span><span class="nx">naturalHeight</span> <span class="o">||</span> <span class="nx">imgElement</span><span class="p">.</span><span class="nx">offsetHeight</span> <span class="o">||</span> <span class="nx">imgElement</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>

  <span class="nx">context</span><span class="p">.</span><span class="nx">drawImage</span><span class="p">(</span><span class="nx">imgElement</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">imageData</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">getImageData</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">width</span><span class="p">,</span> <span class="nx">height</span><span class="p">).</span><span class="nx">data</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">imageData</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">averageColor</span><span class="p">.</span><span class="nx">r</span> <span class="o">+=</span> <span class="nx">imageData</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="nx">averageColor</span><span class="p">.</span><span class="nx">g</span> <span class="o">+=</span> <span class="nx">imageData</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
    <span class="nx">averageColor</span><span class="p">.</span><span class="nx">b</span> <span class="o">+=</span> <span class="nx">imageData</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">];</span>
  <span class="p">}</span>

  <span class="kd">const</span> <span class="nx">count</span> <span class="o">=</span> <span class="nx">length</span> <span class="o">/</span> <span class="mi">4</span><span class="p">;</span>
  <span class="nx">averageColor</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="o">~~</span><span class="p">(</span><span class="nx">averageColor</span><span class="p">.</span><span class="nx">r</span> <span class="o">/</span> <span class="nx">count</span><span class="p">);</span> <span class="c1">// ~~ =&gt; convert to int</span>
  <span class="nx">averageColor</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="o">~~</span><span class="p">(</span><span class="nx">averageColor</span><span class="p">.</span><span class="nx">g</span> <span class="o">/</span> <span class="nx">count</span><span class="p">);</span>
  <span class="nx">averageColor</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="o">~~</span><span class="p">(</span><span class="nx">averageColor</span><span class="p">.</span><span class="nx">b</span> <span class="o">/</span> <span class="nx">count</span><span class="p">);</span>

  <span class="c1">// 저장!</span>
  <span class="nx">cache</span><span class="p">[</span><span class="nx">imgElement</span><span class="p">.</span><span class="nx">src</span><span class="p">]</span> <span class="o">=</span> <span class="nx">averageColor</span><span class="p">;</span>

  <span class="k">return</span> <span class="nx">averageColor</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><br /></p><h3 id="2-memoization-함수-만들기"><span class="mr-2">(2) memoization 함수 만들기</span><a href="#2-memoization-함수-만들기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="c1">// memoize(func)(arg) === func(arg)</span>
<span class="kd">function</span> <span class="nx">memoize</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">cache</span><span class="o">=</span><span class="p">{};</span>
    
    <span class="k">return</span> <span class="kd">function</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">fn</span><span class="p">(...</span><span class="nx">args</span><span class="p">);</span>
        <span class="p">};</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nx">cache</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">args</span><span class="p">)){</span>
            <span class="k">return</span> <span class="nx">cache</span><span class="p">[</span><span class="nx">args</span><span class="p">];</span>
        <span class="p">};</span>
        
        <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">(...</span><span class="nx">args</span><span class="p">);</span>
        <span class="nx">cache</span><span class="p">[</span><span class="nx">args</span><span class="p">]</span> <span class="o">=</span> <span class="nx">result</span><span class="p">;</span>
        
        <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">};</span> 
<span class="p">};</span>

</pre></table></code></div></div><ul><li>이제 메모이제이션 함수로만 래핑을 하면 캐시를 사용할 수 있다.<li>팩토리 패턴 활용<li>메모이제이션은 메모리가 많이든다. input값이 매번 다른 경우에는 사용하지 않는 것을 추천한다.</ul><p><br /></p><h2 id="6-병목-함수-로직-개선하기"><span class="mr-2">6) 병목 함수 로직 개선하기</span><a href="#6-병목-함수-로직-개선하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">렌더링 성능 최적화</code></p><p>함수의 로직 자체를 최적화 해도 성능이 개선된다.</p><p><br /></p><p><img data-src="https://raw.githubusercontent.com/JaeKP/image_repo/main/img/image-20221112150926998.png" alt="image-20221112150926998" data-proofer-ignore></p><ul><li>퍼포먼스 탭을 통한 함수 성능을 분석한 뒤, 어디서 정체가 되는지 파악하고 개선한다.</ul><p><br /></p><h3 id="1-drawimage-getimagedata--개선"><span class="mr-2">(1) drawImage, getImageData 개선</span><a href="#1-drawimage-getimagedata--개선" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>직접 함수의 로직을 개선할 수 없는데 어떻게 성능 최적화를 할 수 있을까.</p><ul><li>캔버스에 이미지 데이터를 그리는 작업이기 때문에 이미지 사이즈와 캔버스의 크기가 클 수록 그리는 속도는 느려질 것이다.<li>이미지를 사이즈를 작게 해서 가져오거나, 캔버스 사이즈를 줄이면 성능이 개선 될 수 있을 것이다.</ul><p><br /></p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">function</span> <span class="nx">getAverageColorOfImage</span><span class="p">(</span><span class="nx">imgElement</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// .. 생략</span>
   
  <span class="c1">// 캔버스 사이즈 줄이기</span>
  <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="nx">width</span> <span class="o">/</span> <span class="mi">3</span><span class="p">;</span>
  <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">height</span> <span class="o">/</span> <span class="mi">3</span><span class="p">;</span>

  <span class="nx">context</span><span class="p">.</span><span class="nx">drawImage</span><span class="p">(</span><span class="nx">imgElement</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">imageData</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">getImageData</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="nx">canvas</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span>
    <span class="nx">canvas</span><span class="p">.</span><span class="nx">height</span>
  <span class="p">).</span><span class="nx">data</span><span class="p">;</span>
    
  <span class="c1">//.. 생략 </span>
<span class="p">}</span>
</pre></table></code></div></div><p><br /></p><h3 id="2-반복문-개선"><span class="mr-2">(2) 반복문 개선</span><a href="#2-반복문-개선" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>모든 픽셀을 조사할 필요가없다. 띄엄띄엄 조사하자.</ul><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">function</span> <span class="nx">getAverageColorOfImage</span><span class="p">(</span><span class="nx">imgElement</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// .. 생략</span>
   
  <span class="c1">// 이전에는 rgba에서 a를 제외하기 위해 i += 4 였음.</span>
  <span class="c1">// 10개 픽셀중 한개를 조사하기 위해 40으로 수정.</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">40</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">averageColor</span><span class="p">.</span><span class="nx">r</span> <span class="o">+=</span> <span class="nx">imageData</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="nx">averageColor</span><span class="p">.</span><span class="nx">g</span> <span class="o">+=</span> <span class="nx">imageData</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
    <span class="nx">averageColor</span><span class="p">.</span><span class="nx">b</span> <span class="o">+=</span> <span class="nx">imageData</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">];</span>
  <span class="p">}</span>

  <span class="kd">const</span> <span class="nx">count</span> <span class="o">=</span> <span class="nx">length</span> <span class="o">/</span> <span class="mi">40</span><span class="p">;</span>
  <span class="nx">averageColor</span><span class="p">.</span><span class="nx">r</span> <span class="o">=</span> <span class="o">~~</span><span class="p">(</span><span class="nx">averageColor</span><span class="p">.</span><span class="nx">r</span> <span class="o">/</span> <span class="nx">count</span><span class="p">);</span>
  <span class="nx">averageColor</span><span class="p">.</span><span class="nx">g</span> <span class="o">=</span> <span class="o">~~</span><span class="p">(</span><span class="nx">averageColor</span><span class="p">.</span><span class="nx">g</span> <span class="o">/</span> <span class="nx">count</span><span class="p">);</span>
  <span class="nx">averageColor</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="o">~~</span><span class="p">(</span><span class="nx">averageColor</span><span class="p">.</span><span class="nx">b</span> <span class="o">/</span> <span class="nx">count</span><span class="p">);</span>
    
  <span class="c1">//.. 생략 </span>
<span class="p">}</span>
</pre></table></code></div></div><p><br /></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web/'>WEB</a>, <a href='/categories/performance/'>Performance</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/perfomance/" class="post-tag no-text-decoration" >perfomance</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%EC%8B%A4%EC%A0%84-%EC%9B%B9-%EC%84%B1%EB%8A%A5-%EC%B5%9C%EC%A0%81%ED%99%94-%28feat.+React%29-Part2+-+Hello%2C+World%21&url=https%3A%2F%2Fjaekp.github.io%2Fposts%2Fperformance03%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%EC%8B%A4%EC%A0%84-%EC%9B%B9-%EC%84%B1%EB%8A%A5-%EC%B5%9C%EC%A0%81%ED%99%94-%28feat.+React%29-Part2+-+Hello%2C+World%21&u=https%3A%2F%2Fjaekp.github.io%2Fposts%2Fperformance03%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fjaekp.github.io%2Fposts%2Fperformance03%2F&text=%EC%8B%A4%EC%A0%84-%EC%9B%B9-%EC%84%B1%EB%8A%A5-%EC%B5%9C%EC%A0%81%ED%99%94-%28feat.+React%29-Part2+-+Hello%2C+World%21" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/mogodb01/">MongoDB-환경설정과-간단한-CRUD구현하기</a><li><a href="/posts/performance03/">실전-웹-성능-최적화-(feat. React)-Part2</a><li><a href="/posts/performance01/">실전-웹-성능-최적화-(feat. React)-Part1</a><li><a href="/posts/nft03/">03-Solidity-문법-기초</a><li><a href="/posts/nft04/">03-DApp-web3를-이용하여-이더리움과-상호작용하기</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/til/">til</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/vue/">vue</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/django/">django</a> <a class="post-tag" href="/tags/project/">project</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/css/">css</a> <a class="post-tag" href="/tags/react/">React</a> <a class="post-tag" href="/tags/moviewiki/">MovieWiki</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/performance01/"><div class="card-body"> <em class="timeago small" data-ts="1665759600" > 2022-10-15 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>실전-웹-성능-최적화-(feat. React)-Part1</h3><div class="text-muted small"><p> 강의 링크 웹 성능은 크게 두 가지로 분류할 수 있다. 바로, 로딩 성능과 렌더링 성능이다. 로딩 성능: 각 리소스를 불러오는 성능을 의미한다. 렌더링 성능: 불러온 리소스를 화면에 보여주는 성능을 의미한다. 1. 블로그 사이트 최적화 총 4 가지의 분석 툴을 사용하여 사이트의 최적화를 진행한다. 크롬 Network 탭 ...</p></div></div></a></div><div class="card"> <a href="/posts/performance02/"><div class="card-body"> <em class="timeago small" data-ts="1666450800" > 2022-10-23 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>견고한-UI-설계를-위한-마크업-가이드-Part1-HTML</h3><div class="text-muted small"><p> 강의 링크 HTML은 문서의 골격, 분위기, 느낌을 제공한다. 웹에서 의사소통을 할 때, 문서의 골격을 제공하고 의미를 제공하여 사용자가 어떻게 읽어야 하는지 제공한다. 1. HTML Content 분류 Flow content (플로우 컨텐츠) body에 포함할 수 있는 모든 요소이다. ...</p></div></div></a></div><div class="card"> <a href="/posts/graphql01/"><div class="card-body"> <em class="timeago small" data-ts="1675263600" > 2023-02-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GraphQL-기초</h3><div class="text-muted small"><p> 공식 문서 1. GraphQL이란 GraphQL은 SQL과 마찬가지로 쿼리 언어 중 하나이다. SQL: 데이터 베이스 시스템에 저장된 데이터를 효율적으로 가져오는 것이 목적 GraphQL:웹 클라이언트가 데이터를 서버로부터 효율적으로 가져오는 것이 목적 즉, 클라이언트와 서버간 통신을 위해 주로 사용된다. 1) 장점 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/performance02/" class="btn btn-outline-primary" prompt="Older"><p>견고한-UI-설계를-위한-마크업-가이드-Part1-HTML</p></a> <a href="/posts/graphql01/" class="btn btn-outline-primary" prompt="Newer"><p>GraphQL-기초</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/JaeKP">박재경</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/til/">til</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/vue/">vue</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/django/">django</a> <a class="post-tag" href="/tags/project/">project</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/css/">css</a> <a class="post-tag" href="/tags/react/">React</a> <a class="post-tag" href="/tags/moviewiki/">MovieWiki</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
