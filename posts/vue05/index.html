<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="이미지-유효성-검사와-Compressor" /><meta name="author" content="박재경" /><meta property="og:locale" content="ko" /><meta name="description" content="SNS서비스를 만드는 프로젝트를 하면서, 이미지를 처리해야 하는 경우가 많았다. 이미지 용량을 줄이는 compressor라이브러리 사용법과 file input에 대한 유효성 검사 함수를 정리했다." /><meta property="og:description" content="SNS서비스를 만드는 프로젝트를 하면서, 이미지를 처리해야 하는 경우가 많았다. 이미지 용량을 줄이는 compressor라이브러리 사용법과 file input에 대한 유효성 검사 함수를 정리했다." /><link rel="canonical" href="https://jaekp.github.io/posts/vue05/" /><meta property="og:url" content="https://jaekp.github.io/posts/vue05/" /><meta property="og:site_name" content="Hello, World!" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-08-10T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="이미지-유효성-검사와-Compressor" /><meta name="google-site-verification" content="LP7vGYSUszERSVMH1MoT4NXRTCcbUaUtfFm_pOYcoQ4" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"박재경"},"dateModified":"2022-08-10T00:00:00+09:00","datePublished":"2022-08-10T00:00:00+09:00","description":"SNS서비스를 만드는 프로젝트를 하면서, 이미지를 처리해야 하는 경우가 많았다. 이미지 용량을 줄이는 compressor라이브러리 사용법과 file input에 대한 유효성 검사 함수를 정리했다.","headline":"이미지-유효성-검사와-Compressor","mainEntityOfPage":{"@type":"WebPage","@id":"https://jaekp.github.io/posts/vue05/"},"url":"https://jaekp.github.io/posts/vue05/"}</script><title>이미지-유효성-검사와-Compressor | Hello, World!</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Hello, World!"><meta name="application-name" content="Hello, World!"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/mococo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Hello, World!</a></div><div class="site-subtitle font-italic">난 재경쓰!</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/JaeKP" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['jkp71192','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>이미지-유효성-검사와-Compressor</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>이미지-유효성-검사와-Compressor</h1><div class="post-meta text-muted"><div> By <em> 박재경 </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1660057200" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-08-10 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="918 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><p>SNS서비스를 만드는 프로젝트를 하면서, 이미지를 처리해야 하는 경우가 많았다. 이미지 용량을 줄이는 compressor라이브러리 사용법과 file input에 대한 유효성 검사 함수를 정리했다.</p><p><br /></p><h2 id="1-이미지-크기-제한"><span class="mr-2">1) 이미지 크기 제한</span><a href="#1-이미지-크기-제한" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c1">// 정해진 파일 크기보다 큰 파일이라면 false를 반환한다. (max: 최대 이미지 mb, fileSize: 업로드한 이미지 용량)</span>
<span class="kd">function</span> <span class="nx">checkImageSize</span><span class="p">(</span><span class="nx">fileData</span><span class="p">:</span> <span class="p">{</span> <span class="nl">max</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span> <span class="nl">fileSize</span><span class="p">:</span> <span class="kr">number</span> <span class="p">}):</span> <span class="nx">boolean</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">max</span><span class="p">,</span> <span class="nx">fileSize</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">fileData</span><span class="p">;</span>

  <span class="c1">// 제한되는 사이즈</span>
  <span class="kd">const</span> <span class="nx">maxSize</span> <span class="o">=</span> <span class="nx">max</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">maxSize</span> <span class="o">&lt;=</span> <span class="nx">fileSize</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><br /></p><h2 id="2-이미지-확장자-제한"><span class="mr-2">2) 이미지 확장자 제한</span><a href="#2-이미지-확장자-제한" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1">// 정해진 파일 확장자가 아니라면 false를 반환한다. (fileName: 이미지 이름)</span>
<span class="kd">function</span> <span class="nx">checkImageExtension</span><span class="p">(</span><span class="nx">fileName</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nx">boolean</span> <span class="p">{</span>
  <span class="c1">// 이미지 확장자</span>
  <span class="kd">const</span> <span class="nx">imageExtensions</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">gif</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">jpg</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">jpeg</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">png</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">bmp</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ico</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">apng</span><span class="dl">"</span><span class="p">];</span>

  <span class="c1">// 업로드한 파일 확장자 ('.'이후의 문자를 소문자로 변환)</span>
  <span class="kd">const</span> <span class="nx">extension</span> <span class="o">=</span> <span class="nx">fileName</span>
    <span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="nx">fileName</span><span class="p">.</span><span class="nx">lastIndexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">.</span><span class="dl">"</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">toLocaleLowerCase</span><span class="p">();</span>

  <span class="c1">// 업로드한 파일 확장자가 이미지 확장자인지 확인한다. </span>
  <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">imageExtensions</span><span class="p">.</span><span class="nx">some</span><span class="p">((</span><span class="nx">item</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">item</span> <span class="o">===</span> <span class="nx">extension</span><span class="p">);</span>

  <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><br /></p><h2 id="3-이미지-compressor"><span class="mr-2">3) 이미지 Compressor</span><a href="#3-이미지-compressor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://github.com/fengyuanchen/compressorjs">compressor.js 공식 문서</a></p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="nx">Compressor</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">compressorjs</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// 이미지 compressor (file: 업로드한 파일 )</span>
<span class="kd">function</span> <span class="nx">compressorImage</span><span class="p">(</span><span class="nx">file</span><span class="p">:</span> <span class="nx">File</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">File</span><span class="o">&gt;</span> <span class="p">{</span>
    
  <span class="c1">// 프로미스 객체를 반환한다. </span>
  <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">new</span> <span class="nx">Compressor</span><span class="p">(</span><span class="nx">file</span><span class="p">,</span> <span class="p">{</span>
      
      <span class="c1">// compressor 옵션 </span>
      <span class="na">checkOrientation</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
      <span class="na">quality</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
      <span class="na">maxWidth</span><span class="p">:</span> <span class="mi">1920</span><span class="p">,</span>
      <span class="na">maxHeight</span><span class="p">:</span> <span class="mi">1920</span><span class="p">,</span>
        
      <span class="c1">// compressor에 성공했을 경우, 파일로 저장하여 반환한다.  </span>
      <span class="nx">success</span><span class="p">(</span><span class="na">result</span><span class="p">:</span> <span class="nx">File</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">compressorImage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">File</span><span class="p">([</span><span class="nx">result</span><span class="p">],</span> <span class="nx">result</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="p">{</span>
          <span class="na">type</span><span class="p">:</span> <span class="nx">result</span><span class="p">.</span><span class="kd">type</span><span class="p">,</span>
        <span class="p">});</span>
        <span class="nx">resolve</span><span class="p">(</span><span class="nx">compressorImage</span><span class="p">);</span>
      <span class="p">},</span>
      
      <span class="c1">// compressor에 실패했을 경우, </span>
      <span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">reject</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
      <span class="p">},</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">}</span>

</pre></table></code></div></div><p><br /></p><h2 id="4-실제-적용-로직-vue3"><span class="mr-2">4) 실제 적용 로직 (vue3)</span><a href="#4-실제-적용-로직-vue3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span><span class="nx">checkImageSize</span><span class="p">,</span> <span class="nx">compressorImage</span><span class="p">,</span> <span class="nx">checkImageExtension</span><span class="p">,}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../../functions/image</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// fileInput의 change 이벤트가 발생할 때 실행한다. </span>
<span class="kd">const</span> <span class="nx">changeCustomCocktailImage</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">:</span> <span class="nx">Event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">file</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span> <span class="k">as</span> <span class="nx">HTMLInputElement</span><span class="p">).</span><span class="nx">files</span><span class="o">!</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

  <span class="c1">// 파일을 업로드 하지 않고 취소 버튼을 누르는 경우</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">file</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// 업로드한 파일이 이미지가 아닌경우</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">checkImageExtension</span><span class="p">(</span><span class="nx">file</span><span class="p">.</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span>
      <span class="dl">"</span><span class="s2">modal/changeErrorModalMessage</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">올바른 이미지 파일을 업로드 하세요.</span><span class="dl">"</span>
    <span class="p">);</span>
    <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="dl">"</span><span class="s2">modal/blinkErrorModalAppStatus</span><span class="dl">"</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// 이미지 용량이 5mb초과면 compressor를 진행한다.</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">checkImageSize</span><span class="p">({</span> <span class="na">max</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="na">fileSize</span><span class="p">:</span> <span class="nx">file</span><span class="p">.</span><span class="nx">size</span> <span class="p">}))</span> <span class="p">{</span>
    <span class="nx">compressorImage</span><span class="p">(</span><span class="nx">file</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        
      <span class="c1">// compressor를 진행해도 이미지 용량이 10mb 초과면 알림을 보낸다. </span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">checkImageSize</span><span class="p">({</span> <span class="na">max</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="na">fileSize</span><span class="p">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">size</span> <span class="p">}))</span> <span class="p">{</span>
        <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span>
          <span class="dl">"</span><span class="s2">modal/changeErrorModalMessage</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">이미지가 너무 큽니다.</span><span class="dl">"</span>
        <span class="p">);</span>
        <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="dl">"</span><span class="s2">modal/blinkErrorModalAppStatus</span><span class="dl">"</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
          
     <span class="c1">// compressor를 진행 후, 이미지 용량이 10mb 이하면 업로드 한다. </span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
          <span class="na">img</span><span class="p">:</span> <span class="nx">result</span><span class="p">,</span>
        <span class="p">};</span>
        <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="dl">"</span><span class="s2">customCocktail/uploadImage</span><span class="dl">"</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
        <span class="nx">emit</span><span class="p">(</span><span class="dl">"</span><span class="s2">changeImage</span><span class="dl">"</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">img</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">});</span>

    <span class="c1">// 이미지 용량이 5mb 이하면 compressor 없이 그냥 업로드 한다.</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">img</span><span class="p">:</span> <span class="nx">file</span><span class="p">,</span>
    <span class="p">};</span>
    <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="dl">"</span><span class="s2">customCocktail/uploadImage</span><span class="dl">"</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
    <span class="nx">emit</span><span class="p">(</span><span class="dl">"</span><span class="s2">changeImage</span><span class="dl">"</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">img</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">event.target.files[0]</code>을 통해 파일을 가져온다.<li>만약 파일이 아니거나 이미지 파일이 아니면 바로 return 한다.<li>이미지 파일이 5mb 초과면 compressor를 진행한다.<ul><li>compressor를 진행해도 이미지가 10mb 초과이면 알림을 보내고 바로 return한다.<li>compressor를 진행 후, 이미지가 10mb 이하이면 파일을 서버에 보낸다.</ul><li>이미지 파일이 5mb 이하면 compressor 없이 바로 서버에 보낸다.</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web/'>WEB</a>, <a href='/categories/vue/'>Vue</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/vue/" class="post-tag no-text-decoration" >vue</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%9C%A0%ED%9A%A8%EC%84%B1-%EA%B2%80%EC%82%AC%EC%99%80-Compressor+-+Hello%2C+World%21&url=https%3A%2F%2Fjaekp.github.io%2Fposts%2Fvue05%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%9C%A0%ED%9A%A8%EC%84%B1-%EA%B2%80%EC%82%AC%EC%99%80-Compressor+-+Hello%2C+World%21&u=https%3A%2F%2Fjaekp.github.io%2Fposts%2Fvue05%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fjaekp.github.io%2Fposts%2Fvue05%2F&text=%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%9C%A0%ED%9A%A8%EC%84%B1-%EA%B2%80%EC%82%AC%EC%99%80-Compressor+-+Hello%2C+World%21" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/mogodb01/">MongoDB-환경설정과-간단한-CRUD구현하기</a><li><a href="/posts/performance03/">실전-웹-성능-최적화-(feat. React)-Part2</a><li><a href="/posts/performance01/">실전-웹-성능-최적화-(feat. React)-Part1</a><li><a href="/posts/nft03/">03-Solidity-문법-기초</a><li><a href="/posts/nft04/">03-DApp-web3를-이용하여-이더리움과-상호작용하기</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/til/">til</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/vue/">vue</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/django/">django</a> <a class="post-tag" href="/tags/project/">project</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/css/">css</a> <a class="post-tag" href="/tags/react/">React</a> <a class="post-tag" href="/tags/moviewiki/">MovieWiki</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/vue00/"><div class="card-body"> <em class="timeago small" data-ts="1656601200" > 2022-07-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>꼭-알아야-하는-vue3-변경사항-톺아보기</h3><div class="text-muted small"><p> 1. v-model의 변화 Vue 3에서는 혼동을 줄이고 개발자가 v-model 디렉티브를 보다 유연하게 사용할 수 있도록, 양방향 데이터 바인딩을 위한 API가 표준화되었다. 공식문서 1) 컴포넌트에 사용되는 v-model의 prop 및 event 사용법이 변경 2.x 3.x ...</p></div></div></a></div><div class="card"> <a href="/posts/vue01/"><div class="card-body"> <em class="timeago small" data-ts="1658156400" > 2022-07-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>vue3에서-타입스크립트로-vuex4-사용하기</h3><div class="text-muted small"><p> vue3환경에서 타입스크립트로 vuex를 사용하는 방법을 정리해보았다. 먼저, vuex4를 설치한다. $ npm install vuex@next --save 1. 기본 준비 1) main.ts에 스토어를 세팅한다 import { createApp } from &quot;vue&quot;; import &quot;./style.css&quot;; import App from...</p></div></div></a></div><div class="card"> <a href="/posts/vue02/"><div class="card-body"> <em class="timeago small" data-ts="1658502000" > 2022-07-23 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ERROR-Vue3-CompositionAPI에서-동적-컴포넌트-사용하는-방법</h3><div class="text-muted small"><p> 😥 문제 상황 회원 관리 기능을 구현하면서 비밀번호 찾기 view에서 사용자의 진행 단계에 따라 컴포넌트가 변경되어 보여주는 페이지를 만들고 있는 중에 오류가 발생했다. 간단하게 동적 컴포넌트를 활용하여 구현하려 했으나, 기존의 Vue2 방식으로 동적 컴포넌트를 설정했더니 작동이 되지 않는 오류가 발생했다. 작동이 되지 않는 코드는 다음과 같다. ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/computerstructure08/" class="btn btn-outline-primary" prompt="Older"><p>컴퓨터구조-입출력-구조</p></a> <a href="/posts/nft01/" class="btn btn-outline-primary" prompt="Newer"><p>01-블록체인-기초-개념</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/JaeKP">박재경</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/til/">til</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/vue/">vue</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/django/">django</a> <a class="post-tag" href="/tags/project/">project</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/css/">css</a> <a class="post-tag" href="/tags/react/">React</a> <a class="post-tag" href="/tags/moviewiki/">MovieWiki</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
