<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="ERROR-Vue3-router에서-네비게이션-가드-설정하는-방법" /><meta name="author" content="박재경" /><meta property="og:locale" content="ko" /><meta name="description" content="네비게이션 가드 공식문서" /><meta property="og:description" content="네비게이션 가드 공식문서" /><link rel="canonical" href="https://jaekp.github.io/posts/vue03/" /><meta property="og:url" content="https://jaekp.github.io/posts/vue03/" /><meta property="og:site_name" content="Hello, World!" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-27T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ERROR-Vue3-router에서-네비게이션-가드-설정하는-방법" /><meta name="google-site-verification" content="LP7vGYSUszERSVMH1MoT4NXRTCcbUaUtfFm_pOYcoQ4" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"박재경"},"dateModified":"2022-07-27T00:00:00+09:00","datePublished":"2022-07-27T00:00:00+09:00","description":"네비게이션 가드 공식문서","headline":"ERROR-Vue3-router에서-네비게이션-가드-설정하는-방법","mainEntityOfPage":{"@type":"WebPage","@id":"https://jaekp.github.io/posts/vue03/"},"url":"https://jaekp.github.io/posts/vue03/"}</script><title>ERROR-Vue3-router에서-네비게이션-가드-설정하는-방법 | Hello, World!</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Hello, World!"><meta name="application-name" content="Hello, World!"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/mococo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Hello, World!</a></div><div class="site-subtitle font-italic">난 재경쓰!</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/JaeKP" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['jkp71192','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>ERROR-Vue3-router에서-네비게이션-가드-설정하는-방법</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>ERROR-Vue3-router에서-네비게이션-가드-설정하는-방법</h1><div class="post-meta text-muted"><div> By <em> 박재경 </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1658847600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-07-27 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1446 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><p><code class="language-plaintext highlighter-rouge">네비게이션 가드</code> <a href="https://router.vuejs.org/guide/advanced/navigation-guards.html">공식문서</a></p><p>네비게이션 가드란 특정 페이지를 보호하기 위해 사용하는 방법으로서 URL의 접근을 제한하는 것을 의미한다.</p><p><br /></p><h2 id="-문제-상황"><span class="mr-2">😥 문제 상황</span><a href="#-문제-상황" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><p>로그인을 하지 않은 유저: <code class="language-plaintext highlighter-rouge">개인 정보 수정</code>, <code class="language-plaintext highlighter-rouge">회원 탈퇴</code> 페이지에 접근을 못한다.</p><li><p>로그인을 한 유저: <code class="language-plaintext highlighter-rouge">로그인</code>, <code class="language-plaintext highlighter-rouge">회원가입</code> 페이지에 접근을 못한다.</p></ul><p><br /></p><p>회원 관리에 관한 페이지를 개발한 후, 로그인 여부에 따라 페이지에 접근할 수 있는 것을 제한하려 했다. 그러나 로그인 여부 자체를 인식하지 못했다.</p><p><br /></p><h3 id="1-로그인-유저인지-확인을-못하나"><span class="mr-2">1) 로그인 유저인지 확인을 못하나..?</span><a href="#1-로그인-유저인지-확인을-못하나" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><code class="language-plaintext highlighter-rouge">로그인유저 확인 로직</code></p><ul><li>로그인 했을 때, 유저의 access토큰과 refresh토큰을 로컬 스토리지와 vuex에 저장한다.<li>브라우저를 재 시작 했을 때, 로컬 스토리지에 토큰 정보가 있으면 이를 vuex에 저장한다.<li>vuex에 토큰이 저장되어 있을 경우 해당 유저는 로그인 유저로 간주한다.</ul><p><br /></p><p><img data-src="https://raw.githubusercontent.com/JaeKP/image_repo/main/img/image-20220729230058080.png" alt="image-20220729230058080" data-proofer-ignore></p><p>vuex를 확인해보면, 로그인 여부는 잘 확인하고 있는 것을 알 수 있었다.</p><p><br /></p><h3 id="2-router-코드가-문젠가"><span class="mr-2">2) Router 코드가 문젠가..</span><a href="#2-router-코드가-문젠가" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="c1">// src/router.ts </span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">computed</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">useStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vuex</span><span class="dl">"</span>
<span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">useStore</span><span class="p">()</span>


<span class="c1">// Navigation Guard 설정: 오류를 해결하기 위해 임의로 any타입을 사용했다. </span>
<span class="nx">router</span><span class="p">.</span><span class="nx">beforeEach</span><span class="p">((</span><span class="nx">to</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span> <span class="k">from</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// 로그인 여부 확인</span>
  <span class="kd">const</span> <span class="nx">isLoggedIn</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">getters</span><span class="p">[</span><span class="dl">"</span><span class="s2">personalInfo/isLoggedIn</span><span class="dl">"</span><span class="p">]);</span>

  <span class="c1">// 로그인이 필요한 페이지</span>
  <span class="kd">const</span> <span class="nx">authPages</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">TheSignOutView</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">TheChangeUserView</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">TheChangePwView</span><span class="dl">"</span><span class="p">];</span>

  <span class="c1">// 로그인이 되어있지 않을 때만 가능한 페이지</span>
  <span class="kd">const</span> <span class="nx">notAuthPages</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">TheSignupView</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">TheLoginView</span><span class="dl">"</span><span class="p">];</span>

  <span class="c1">// 1. 현재 이동하고자 하는 페이지가 로그인이 필요한지 확인</span>
  <span class="kd">const</span> <span class="nx">isAuthRequired</span> <span class="o">=</span> <span class="nx">authPages</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">to</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">isNotAuthRequired</span> <span class="o">=</span> <span class="nx">notAuthPages</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">to</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>

  <span class="c1">// 2. 로그인이 필요한 페이지인데 로그인이 되어있지 않다면 로그인 페이지(/login)로 이동</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">isAuthRequired</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isLoggedIn</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">next</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">TheLoginView</span><span class="dl">"</span> <span class="p">});</span>

    <span class="c1">// 3. 로그인이 되어있는데 /login, /signup 페이지로 이동한다면 메인 페이지(/)로 이동</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">isNotAuthRequired</span> <span class="o">&amp;&amp;</span> <span class="nx">isLoggedIn</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">next</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">TheHomeView</span><span class="dl">"</span> <span class="p">});</span>

    <span class="c1">// 4.  원래 이동 페이지</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">next</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></table></code></div></div><p>router.ts에 네비게이션 가드로 작성한 코드가 로직적인 문제가 있는지 확인해 보았다.</p><ol><li>현재 유저가 로그인 유저인지 확인한다.<li>유저의 로그인 상태에 따라 접근할 수 있는 페이지와 접근할 수 없는 페이지를 나눈다.<li>현재 이동하고자 하는 페이지가 어떤 페이지 인지 확인한다.<ul><li>현재 이동하고자 하는 페이지가 어디에 속해있는지 <code class="language-plaintext highlighter-rouge">includes</code>함수를 통해 확인</ul><li>1~3에서 확인한 <code class="language-plaintext highlighter-rouge">유저의 로그인 여부</code>와 <code class="language-plaintext highlighter-rouge">이동하고자 하는 페이지의 종류</code>에 따라 이동되는 분기가 나뉜다.<ul><li>권한이 없는 페이지에 이동하려고 할 시, 지정된 페이지로 이동<li>권한이 있는 페이지에 이동하려고 할 시, 원래 이동하려고 하는 페이지로 이동</ul></ol><p><br /></p><p>로직은 큰 문제가 없는 것 같은데.. 🤔</p><p><br /></p><h2 id="️-해결-방법"><span class="mr-2">🤸‍♂️ 해결 방법</span><a href="#️-해결-방법" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>위의 코드에서 문제가 되는 부분은 다음과 같다.</p><p><br /></p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1">// src/router.ts </span>

<span class="kd">const</span> <span class="nx">isLoggedIn</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">getters</span><span class="p">[</span><span class="dl">"</span><span class="s2">personalInfo/isLoggedIn</span><span class="dl">"</span><span class="p">]);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">isLoggedIn</span><span class="p">)</span>
</pre></table></code></div></div><p>console에 찍어보니 <code class="language-plaintext highlighter-rouge">undefined</code>가 출력 되어 로그인 여부를 확인할 수 없는 것이다. 분명 store에는 값이 잘 저장되어 있는데 왜 값을 못 가져오는 걸까.</p><p>기존에 컴포넌트에서 store를 접근할 때는 <code class="language-plaintext highlighter-rouge">useStore</code>라는 메서드를 통해 접근할 수 있기 때문에 외부 ts파일도 이렇게 접근이 가능할 것이라고 생각했었다. 그러나 같은 코드로 접근하면 안된다.</p><p><br /></p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="c1">// src/main.ts</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">createApp</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">App</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./App.vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">router</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./router</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">store</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./store</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">createApp</span><span class="p">(</span><span class="nx">App</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">store</span><span class="p">).</span><span class="nx">use</span><span class="p">(</span><span class="nx">router</span><span class="p">);</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">mount</span><span class="p">(</span><span class="dl">"</span><span class="s2">#app</span><span class="dl">"</span><span class="p">);</span>
</pre></table></code></div></div><ul><li>vue는 이렇게 main.ts에서 store가 연동되어 있기 때문에 <code class="language-plaintext highlighter-rouge">{useStore}</code>메서드로 접근을 할 수 있다. (추측..)<li>그래서 vue파일이 아닌 외부 파일에서 접근을 하기 위해서는 직접 store에 접근해서 store를 가져와야 한다.</ul><p><br /></p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="c1">// src/store/index.ts</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">createStore</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vuex</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">account</span><span class="p">,</span> <span class="nx">AccountState</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../store/accounts/account</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">signup</span><span class="p">,</span> <span class="nx">SignupState</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../store/accounts/signup</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">password</span><span class="p">,</span> <span class="nx">PasswordState</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../store/accounts/password</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">personalInfo</span><span class="p">,</span> <span class="nx">PersonalInfoState</span><span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../store/accounts/personalInfo</span><span class="dl">"</span><span class="p">;</span>


<span class="c1">// 모듈의 state를 공유한다.</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">RootState</span> <span class="p">{</span>
  <span class="nl">account</span><span class="p">:</span> <span class="nx">AccountState</span><span class="p">;</span>
  <span class="nl">signup</span><span class="p">:</span> <span class="nx">SignupState</span><span class="p">;</span>
  <span class="nl">personalInfo</span><span class="p">:</span> <span class="nx">PersonalInfoState</span><span class="p">;</span>
  <span class="nl">password</span><span class="p">:</span> <span class="nx">PasswordState</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// store를 생성한다.</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">createStore</span><span class="p">({</span>
  <span class="na">modules</span><span class="p">:</span> <span class="p">{</span>
    <span class="nx">account</span><span class="p">,</span>
    <span class="nx">signup</span><span class="p">,</span>
    <span class="nx">personalInfo</span><span class="p">,</span>
    <span class="nx">password</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">});</span>

</pre></table></code></div></div><ul><li>store를 <code class="language-plaintext highlighter-rouge">createStore</code>를 통해 export하고 있기 때문에 <code class="language-plaintext highlighter-rouge">createStore</code>로 vuex의 store에 접근하면 된다.</ul><p><br /></p><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">computed</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">vue</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">createStore</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../src/store/index</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// 스토어 정의</span>
<span class="kd">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">createStore</span><span class="p">;</span>

<span class="c1">// Navigation Guard 설정: 오류를 해결하기 위해 임의로 any타입을 사용했다. </span>
<span class="nx">router</span><span class="p">.</span><span class="nx">beforeEach</span><span class="p">((</span><span class="nx">to</span><span class="p">:</span> <span class="kr">any</span><span class="p">,</span> <span class="k">from</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">isLoggedIn</span> <span class="o">=</span> <span class="nx">computed</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">getters</span><span class="p">[</span><span class="dl">"</span><span class="s2">personalInfo/isLoggedIn</span><span class="dl">"</span><span class="p">]);</span>

  <span class="kd">const</span> <span class="nx">authPages</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">TheSignOutView</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">TheChangeUserView</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">TheChangePwView</span><span class="dl">"</span><span class="p">];</span>
  <span class="kd">const</span> <span class="nx">notAuthPages</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">TheSignupView</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">TheLoginView</span><span class="dl">"</span><span class="p">];</span>

  <span class="kd">const</span> <span class="nx">isAuthRequired</span> <span class="o">=</span> <span class="nx">authPages</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">to</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">isNotAuthRequired</span> <span class="o">=</span> <span class="nx">notAuthPages</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">to</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">isAuthRequired</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isLoggedIn</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">next</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">TheLoginView</span><span class="dl">"</span> <span class="p">});</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">로그인 하지 않은 유저는 돌아가시오</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">isNotAuthRequired</span> <span class="o">&amp;&amp;</span> <span class="nx">isLoggedIn</span><span class="p">.</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">next</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">TheHomeView</span><span class="dl">"</span> <span class="p">});</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">next</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></table></code></div></div><p>문제 없이 잘 작동 하는 것을 확인할 수 있다 😀</p><p><br /></p><p><img data-src="https://raw.githubusercontent.com/JaeKP/image_repo/main/img/image-20220731120805602.png" alt="image-20220731120805602" data-proofer-ignore></p><p><br /></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web/'>WEB</a>, <a href='/categories/vue/'>Vue</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/vue/" class="post-tag no-text-decoration" >vue</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=ERROR-Vue3-router%EC%97%90%EC%84%9C-%EB%84%A4%EB%B9%84%EA%B2%8C%EC%9D%B4%EC%85%98-%EA%B0%80%EB%93%9C-%EC%84%A4%EC%A0%95%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95+-+Hello%2C+World%21&url=https%3A%2F%2Fjaekp.github.io%2Fposts%2Fvue03%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ERROR-Vue3-router%EC%97%90%EC%84%9C-%EB%84%A4%EB%B9%84%EA%B2%8C%EC%9D%B4%EC%85%98-%EA%B0%80%EB%93%9C-%EC%84%A4%EC%A0%95%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95+-+Hello%2C+World%21&u=https%3A%2F%2Fjaekp.github.io%2Fposts%2Fvue03%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fjaekp.github.io%2Fposts%2Fvue03%2F&text=ERROR-Vue3-router%EC%97%90%EC%84%9C-%EB%84%A4%EB%B9%84%EA%B2%8C%EC%9D%B4%EC%85%98-%EA%B0%80%EB%93%9C-%EC%84%A4%EC%A0%95%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95+-+Hello%2C+World%21" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/mogodb01/">MongoDB-환경설정과-간단한-CRUD구현하기</a><li><a href="/posts/performance03/">실전-웹-성능-최적화-(feat. React)-Part2</a><li><a href="/posts/performance01/">실전-웹-성능-최적화-(feat. React)-Part1</a><li><a href="/posts/nft03/">03-Solidity-문법-기초</a><li><a href="/posts/nft04/">03-DApp-web3를-이용하여-이더리움과-상호작용하기</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/til/">til</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/vue/">vue</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/django/">django</a> <a class="post-tag" href="/tags/project/">project</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/css/">css</a> <a class="post-tag" href="/tags/react/">React</a> <a class="post-tag" href="/tags/moviewiki/">MovieWiki</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/vue00/"><div class="card-body"> <em class="timeago small" data-ts="1656601200" > 2022-07-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>꼭-알아야-하는-vue3-변경사항-톺아보기</h3><div class="text-muted small"><p> 1. v-model의 변화 Vue 3에서는 혼동을 줄이고 개발자가 v-model 디렉티브를 보다 유연하게 사용할 수 있도록, 양방향 데이터 바인딩을 위한 API가 표준화되었다. 공식문서 1) 컴포넌트에 사용되는 v-model의 prop 및 event 사용법이 변경 2.x 3.x ...</p></div></div></a></div><div class="card"> <a href="/posts/vue01/"><div class="card-body"> <em class="timeago small" data-ts="1658156400" > 2022-07-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>vue3에서-타입스크립트로-vuex4-사용하기</h3><div class="text-muted small"><p> vue3환경에서 타입스크립트로 vuex를 사용하는 방법을 정리해보았다. 먼저, vuex4를 설치한다. $ npm install vuex@next --save 1. 기본 준비 1) main.ts에 스토어를 세팅한다 import { createApp } from &quot;vue&quot;; import &quot;./style.css&quot;; import App from...</p></div></div></a></div><div class="card"> <a href="/posts/vue02/"><div class="card-body"> <em class="timeago small" data-ts="1658502000" > 2022-07-23 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ERROR-Vue3-CompositionAPI에서-동적-컴포넌트-사용하는-방법</h3><div class="text-muted small"><p> 😥 문제 상황 회원 관리 기능을 구현하면서 비밀번호 찾기 view에서 사용자의 진행 단계에 따라 컴포넌트가 변경되어 보여주는 페이지를 만들고 있는 중에 오류가 발생했다. 간단하게 동적 컴포넌트를 활용하여 구현하려 했으나, 기존의 Vue2 방식으로 동적 컴포넌트를 설정했더니 작동이 되지 않는 오류가 발생했다. 작동이 되지 않는 코드는 다음과 같다. ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ts04/" class="btn btn-outline-primary" prompt="Older"><p>05-TpyeScript-제네릭</p></a> <a href="/posts/vue04/" class="btn btn-outline-primary" prompt="Newer"><p>v-model을-활용하여-멀티-레인지-슬라이더-만들기</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/JaeKP">박재경</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/til/">til</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/vue/">vue</a> <a class="post-tag" href="/tags/cs/">cs</a> <a class="post-tag" href="/tags/django/">django</a> <a class="post-tag" href="/tags/project/">project</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/css/">css</a> <a class="post-tag" href="/tags/react/">React</a> <a class="post-tag" href="/tags/moviewiki/">MovieWiki</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
