---
title: 22/06/16/ëª© Expressì™€ socket.ioë¥¼ í™œìš©í•˜ì—¬ ì±„íŒ… ì„œë¹„ìŠ¤ êµ¬í˜„, Jenkins + dockerë¥¼ í™œìš©í•œ CI/CD êµ¬ì¶•
author: ë°•ì¬ê²½
date: 2022-06-16
categories: [TIL/2022, "06"]
tag: [til, express, node.js, socket.io, jenkins, docker]
---

# 220616 Today I learned!

- [x] Expressì™€ socket.ioë¥¼ í™œìš©í•˜ì—¬ ì±„íŒ… ì„œë¹„ìŠ¤ êµ¬í˜„
- [x] CI/CD í™˜ê²½ì˜ ì´í•´ 

---

## 1. Fact

### 1) Expressì™€ socket.ioë¥¼ í™œìš©í•˜ì—¬ ì±„íŒ… ì„œë¹„ìŠ¤ êµ¬í˜„

- `Express.js`: httpì™€ connect ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜ìœ¼ë¡œ ì„œë²„ë¥¼ ì‰½ê²Œ ë§Œë“¤ê¸° ìœ„í•´ ì‚¬ìš©ëœë‹¤.
- `socket.io`: í´ë¼ì´ì–¸íŠ¸ - ì„œë²„ê°„ ì–‘ë°©í–¥ í†µì‹ ì´ ê°€ëŠ¥í•˜ê²Œ í•˜ì—¬ ì‹¤ì‹œê°„ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ë‹¤. 
  - Websocketì„ ê¸°ë°˜ìœ¼ë¡œ ì‹¤ì‹œê°„ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìœ„í•œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤.
  - í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ ê°„ì˜ ì‹¤ì‹œê°„ ì–‘ë°©í–¥ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•´ì¤€ë‹¤.
  - ì´ë²¤íŠ¸ê¸°ë°˜ìœ¼ë¡œ ì„œë²„ ì†Œì¼“ê³¼ í´ë¼ì´ì–¸íŠ¸ ì†Œì¼“ì„ ì—°ê²°í•˜ì—¬ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ ì–‘ë°©í–¥ í†µì‹ ì´ ê°€ëŠ¥í•˜ê²Œ í•œë‹¤.

[ê²°ê³¼ë¬¼ê³¼ README](https://github.com/JaeKP/mini-toy-projects/tree/master/live-chat-service)



### 2) Jenkins + dockerë¥¼ í™œìš©í•œ CI/CD êµ¬ì¶•

> Jenkinsë¡œ CICD í™˜ê²½ì„ êµ¬ì¶•í•˜ì—¬ í”„ë¡œì íŠ¸ ë°°í¬ë¥¼ ì§€ì†ì ìœ¼ë¡œ ì‰½ê²Œ í•  ìˆ˜ ìˆë‹¤. 

ì˜ˆì „ì— ê¸°ì—… itíŒ€ì€ ê°œë°œíŒ€ê³¼ ìš´ì˜íŒ€ìœ¼ë¡œ ë¶„ë¦¬ë˜ì–´ ìˆì—ˆë‹¤. ë‘˜ì˜ í˜‘ì—… í”„ë¡œì„¸ìŠ¤ê°€ êµ‰ì¥íˆ ë¹„íš¨ìœ¨ì ì´ì˜€ë‹¤.

ê·¸ëŸ¬ë‚˜, ì´ì œ CI/CDê°œë…ì´ ë‚˜ì˜¤ë©´ì„œ ê°œë°œìë“¤ë„ í¸í•˜ê²Œ ë°°í¬ë¥¼ í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤. 

- ê°œë°œ
- ê°œë°œ ë¸ŒëŸ°ì¹˜ë¡œ pushí•œë‹¤. 
- masterë¸ŒëŸ°ì¹˜ë¡œ MR í•œë‹¤. 

- master ë¸ŒëŸ°ì¹˜ì˜ pushë¥¼ ê°ì§€í•˜ì—¬ Jenkins ì„œë²„ì— íŠ¸ë¦¬ê±°ë¥¼ ì•Œë ¤ì¤€ë‹¤.
-  Jenkinsì—ì„œ ë¹Œë“œ í•œë’¤, ëª…ë ¹ì–´ì— ì˜í•´ ë„ì»¤ë¼ì´ì§•(ì»¨í…Œì´ë„ˆí™”) 
-  ë°°í¬ 

<br>

---

## 2. Feeling

ì±„íŒ… ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ì¬ë°Œì–´ì„œ, íŠ¹ê°•ì´ ëë‚˜ê³  ê³„ì† í˜¼ì ì§„í–‰í–ˆë‹¤.

ì„œë²„ êµ¬í˜„ì„ í•˜ê³  í´ë¼ì´ì–¸íŠ¸ í™”ë©´ì„ êµ¬ì„±í•˜ëŠ” ë° ìƒê°ë³´ë‹¤ ë§ì€ ì‹œê°„ì´ ë“¤ì—ˆì§€ë§Œ,, ğŸ¥º

<br>

---

## 3. Finding 

> **socket.io  server êµ¬í˜„ í™œìš©ë²•**
 {: .prompt-info }

[ê³µì‹ë¬¸ì„œ](https://socket.io/)

Socket.IO is a library that enables **low-latency**, **bidirectional** and **event-based** communication between a client and a server.

#### (1) socket.io ê°ì²´ ìƒì„± ë° êµ¬ë™

```javascript
// server.js

const express = require("express");
const { createServer } = require("http");
const { Server } = require("socket.io");

const app = express();

// ì„œë²„ ìƒì„±
const httpServer = createServer(app);
const io = new Server(httpServer, );

// ì„œë²„ë¥¼ socket.ioì— ë°”ì¸ë”©í•œë‹¤.
const httpServer = createServer();
```

<br>

#### (2) í´ë¼ì´ì–¸íŠ¸ì™€ ì†Œí†µ

<img src="https://socket.io/images/bidirectional-communication-socket.png">

```javascript
// server.js

io.sockets.on('connection', function(socket){
  // ìœ ì € ë©”ì‹œì§€ ì „ë‹¬
  socket.on('send', function(data){
    // ë°›ì€ ë°ì´í„°ì— ëˆ„ê°€ ë³´ëƒˆëŠ” ì§€ ì´ë¦„ì„ ì¶”ê°€í•œë‹¤. 
    data.name = socket.name

    // ë³´ë‚¸ ì‚¬ëŒì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ìœ ì €ì—ê²Œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•œë‹¤. 
    socket.broadcast.emit("update", data)
  });

  // ì ‘ì† ì¢…ë£Œ
  socket.on('disconnect', function(data){
    // ì´ë¦„ì´ ì—†ìœ¼ë©´, ë¡œê·¸ì¸ì„ í•˜ì§€ ì•Šì€ ê²ƒì´ê¸° ë•Œë¬¸ì— ì¢…ë£Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ì§€ ì•ŠëŠ”ë‹¤. 
    if (socket.name === undefined) {return}
    console.log(socket.name + "ë‹˜ì´ ë‚˜ê°€ì…¨ìŠµë‹ˆë‹¤.")
      
    // ë‚˜ê°€ëŠ” ì‚¬ëŒì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ìœ ì €ì—ê²Œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•œë‹¤. 
    socket.broadcast.emit("update", {type: "disconnect", name: "SERVER", message: `${socket.name}ë‹˜ì´ ë‚˜ê°€ì…¨ìŠµë‹ˆë‹¤.`})
  });
});
```

- `emit`(ì „ì†¡)ê³¼ `on`(ìˆ˜ì‹ )ì„ í†µí•´ ì†Œí†µí•œë‹¤. 
- `io.socket`: ì „ì²´ ì†Œì¼“ / `socket`: ì ‘ì†ëœ ì†Œì¼“ (ì½œë°±í•¨ìˆ˜ì— ì˜í•´ ì „ë‹¬ë˜ì—ˆìŒ) / `socket.broadcast`: ë‚˜ë¥¼ ì œì™¸í•œ ì†Œì¼“

<br>

---

## 4. Future Action & Feedback

| Future Action       | ì§„í–‰ ìƒí™©     | Feedback   |
| ------------------- | ------------- | ---------- |
| DOMì„ ê¹¨ìš°ì¹˜ë‹¤      | `pause ğŸ¤¦â€â™€ï¸`    | ì ì‹œ ì¤‘ë‹¨! |
| JavsScript DeepDive | `notStartedğŸŒ™` |            |
| ì™€ìëµ¤! ë‹¤ì‹œ ë§Œë“¤ê¸° | `notStartedğŸŒ™` |            |

<br>
